window.pui||(window.pui={});window.pui.baseVersion="6";window.pui.fixPackVersion="3.3";window.pui.version=window.pui.baseVersion+"."+window.pui.fixPackVersion;function b(a){var d;if(!a)a=window.event;if(a.touches!=null&&a.touches.length==1)return a.touches[0].target;if(a.target)d=a.target;else if(a.srcElement)d=a.srcElement;if(d.nodeType==3)d=d.parentNode;return d}function v(a){if(!a)a=window.event;if(window.event){window.event.cancelBubble=true;window.event.returnValue=false}if(a.preventDefault){a.cancelBubble=true;a.preventDefault()}}
function w(a){var d;if(typeof a=="string")a=getObj(a);if(a==null)return-1;if(a.tagName!="INPUT"||!pui.db(a))return-1;if(document.selection!=null){if(a==null)a=document.activeElement;d=document.selection.createRange()}var c=0;if(a!=null&&d!=null&&a.createTextRange!=null)try{var e=a.createTextRange();if(e){for(;d.compareEndPoints("StartToStart",e)>0;){e.moveStart("character",1);c++}return c}}catch(f){return-1}else if(a!=null)try{if(a.selectionStart!=null)return a.selectionStart}catch(g){}return-1}
function y(){if(toolbar==null)return false;if(toolbar.da==null)return false;return true}if(!Array.prototype.forEach)Array.prototype.forEach=function(a,d){for(var c=0,e=this.length;c<e;c++)c in this&&a.call(d,this[c],c,this)};if(!Array.prototype.map)Array.prototype.map=function(a,d){for(var c=Array(this.length),e=0,f=this.length;e<f;e++)if(e in this)c[e]=a.call(d,this[e],e,this);return c};
if(!Array.prototype.filter)Array.prototype.filter=function(a,d){for(var c=[],e,f=0,g=this.length;f<g;f++)if(f in this&&a.call(d,e=this[f],f,this))c.push(e);return c};
if(!Array.prototype.reduce)Array.prototype.reduce=function(a){if(null===this||"undefined"===typeof this)throw new TypeError("Array.prototype.reduce called on null or undefined");if("function"!==typeof a)throw new TypeError(a+" is not a function");var d=Object(this),c=d.length>>>0,e=0,f;if(arguments.length>=2)f=arguments[1];else{for(;e<c&&!e in d;)e++;if(e>=c)throw new TypeError("Reduce of empty array with no initial value");f=d[e++]}for(;e<c;e++)if(e in d)f=a(f,d[e],e,d);return f};
Array.from||(Array.from=function(){var a=Object.prototype.toString;function d(e){return typeof e==="function"||a.call(e)==="[object Function]"}var c=Math.pow(2,53)-1;return function(e){var f=Object(e);if(e==null)throw new TypeError("Array.from requires an array-like object - not null or undefined");var g=arguments.length>1?arguments[1]:void undefined,h;if(typeof g!=="undefined"){if(!d(g))throw new TypeError("Array.from: when provided, the second argument must be a function");if(arguments.length>2)h=
arguments[2]}var j;j=Number(f.length);j=isNaN(j)?0:j===0||!isFinite(j)?j:(j>0?1:-1)*Math.floor(Math.abs(j));j=Math.min(Math.max(j,0),c);for(var l=d(this)?Object(new this(j)):Array(j),k=0,o;k<j;){o=f[k];l[k]=g?typeof h==="undefined"?g(o,k):g.call(h,o,k):o;k+=1}l.length=j;return l}}());
if(!Array.prototype.indexOf)Array.prototype.indexOf=function(a,d,c){return function(e,f){if(this===null||this===undefined)throw TypeError("Array.prototype.indexOf called on null or undefined");var g=a(this),h=g.length>>>0,j=c(f|0,h);if(j<0)j=d(0,h+j);else if(j>=h)return-1;if(e===void 0)for(;j!==h;++j){if(g[j]===void 0&&j in g)return j}else if(e!==e)for(;j!==h;++j){if(g[j]!==g[j])return j}else for(;j!==h;++j)if(g[j]===e)return j;return-1}}(Object,Math.max,Math.min);
if(typeof Object.create!=="function")Object.create=function(a,d){function c(){}if(typeof a!=="object"&&typeof a!=="function")throw new TypeError("Object prototype may only be an Object: "+a);else if(a===null)throw Error("This browser's implementation of Object.create is a shim and doesn't support 'null' as the first argument.");if(typeof d!="undefined")throw Error("This browser's implementation of Object.create is a shim and doesn't support a second argument.");c.prototype=a;return new c};
pui.wd=function(a,d){var c=a[d];if(c==null){var e=d.split(" "),f=Number(e[e.length-1]);if(!isNaN(f)&&f>0){e.pop();e=a[e.join(" ")];if(e!=null){c={};for(var g in e){f=e[g];if(g=="name")c.name=d;else if(typeof f=="object"&&f.length!=null){c[g]=[];for(var h=0;h<f.length;h++)c[g].push(f[h])}else c[g]=e[g]}}}}return c};pui.Ma=function(a,d){for(var c=0;c<a.length;c++)if(a[c]==d)return c;return-1};pui.Sc=function(a,d){for(var c=0;c<a.length;c++)d(a[c])};
pui.$d=function(a,d){if(d==null)d=0;var c=parseInt(a,10);if(isNaN(c))c=d;return c};
pui.Nd=function(){var a={9:"Tab",13:"Enter",16:"Shift",17:"Ctrl",18:"Alt",19:"Pause",20:"Caps Lock",27:"Esc",33:"Page Up",34:"Page Down",35:"End",36:"Home",37:"Left",38:"Up",39:"Right",40:"Down",45:"Insert",3:"Enter",63234:"Left",63235:"Right",63232:"Up",63233:"Down",63276:"Page Up",63277:"Page Down",63272:"Delete",63273:"Home",63275:"End"},d={8:"Backspace",9:"Tab",13:"Enter",27:"Esc",33:"Page Up",34:"Page Down",35:"End",36:"Home",37:"Left",38:"Up",39:"Right",40:"Down",46:"Delete"},c=!/webkit/.test(navigator.userAgent.toLowerCase())&&
/gecko/.test(navigator.userAgent.toLowerCase());if(pui.is_ie)c=false;return function(e,f){var g=String.fromCharCode(e.charCode||e.keyCode);e.ctrlKey||c&&d[e.keyCode]||!c&&a[e.keyCode]&&!g||f.test(g)||v(e)}}();
pui.Na=function(a){if(!(pui.is_touch&&!pui.is_mouse_capable||pui.Dd))if(pui.qc==null)if(pui.Zc&&!pui.ob)if(!(context=="genie"&&pui.Ld())){for(var d=window;d!=null&&d!=d.parent;){d=d.parent;if(pui.$(d))return;try{if(typeof d.pui!="undefined")return}catch(c){}}if(pui.J!=null||!pui.da.ia||context=="dspf"&&pui.da.ia&&typeof pui.hc.isDirty==="function"&&pui.hc.isDirty()){d=pui.Yc?pui.ma:pui.getLanguageText("runtimeMsg","closeMessage");if(context=="genie"&&pui.J.config.ma!=null&&pui.J.config.ma!="")d=pui.J.config.ma;
return a.returnValue=d}}};
pui.unload=function(){if(pui.Hc&&pui.qc==null){pui.halted=true;window.puihalted=true;pui.jc();var a;a=pui.J==null?getProgramURL("PUI0001200.pgm"):getProgramURL("PUI0002110.pgm");if(pui.ib!=null&&pui.ib!="")a+="/"+pui.ib;if(pui.overrideSubmitUrl!=null&&typeof pui.overrideSubmitUrl=="function")try{a=pui.overrideSubmitUrl(a)}catch(d){}if(navigator!=null&&typeof navigator.sendBeacon=="function"&&typeof window.Blob=="function"){var c=new Blob(["shutdown=1"+(pui.isCloud?"&workspace_id="+pui.na.Ia.id:"")],
{type:"application/x-www-form-urlencoded"});navigator.sendBeacon(a,c)}else{c={shutdown:"1"};if(pui.isCloud)c.workspace_id=pui.na.Ia.id;z({url:a,method:"post",ne:true,params:c})}pui.Hc=false}};pui.Tc=function(){if(window.addEventListener){window.addEventListener("beforeunload",pui.Na,false);if(!pui.da.ia||pui.J!=null)window.addEventListener("unload",pui.unload,false)}else if(window.attachEvent){window.attachEvent("onbeforeunload",pui.Na);if(!pui.da.ia||pui.J!=null)window.attachEvent("onunload",pui.unload)}};
pui.Qb=function(a,d,c){var e=document.createElement("form");e.action=getProgramURL("PUI0009106.pgm")+"?contentType="+a+"&fileName="+d;if(pui.isCloud)e.action+="&workspace_id="+pui.na.Ia.id;e.method="post";a=createNamedElement("input","data");a.type="hidden";a.value=c;e.appendChild(a);document.body.appendChild(e);pui.ob=true;e.submit();setTimeout(function(){e.parentNode.removeChild(e);pui.ob=false},0)};
pui.xb=function(a,d){var c=a.className;if(c==null)c="";c=c.split(" ");for(var e=[],f=0;f<c.length;f++){if(c[f]==d)return;c[f]!=""&&e.push(c[f])}e.push(d);a.className=e.join(" ")};pui.jb=function(a,d){a.className=pui.tc(a.className,d)};pui.tc=function(a,d,c){if(a==null)return"";if(a=="")return"";if(c==null||c=="")c=" ";a=a.split(c);c=[];for(var e=0;e<a.length;e++)a[e]!=""&&a[e]!=d&&c.push(a[e]);return c.join(" ")};
pui.ge=function(a,d){if(!(a.readOnly||a.disabled))if(!(d==null||d==null)){var c=a;if(c.Ra!=null)c=c.Ra.getBox();c.emptyText=d;pui.Qa(c);addEvent(c,"focus",function(e){e=b(e);if(e.value==e.emptyText){e.value="";pui.jb(e,"empty-text")}});addEvent(c,"blur",function(e){pui.Qa(b(e))})}};pui.Qa=function(a){if(!(a.readOnly||a.disabled))if(!(a.emptyText==null||a.emptyText==null)){if(a.value=="")a.value=a.emptyText;a.value==a.emptyText?pui.xb(a,"empty-text"):pui.jb(a,"empty-text")}};
pui.Uc=function(){function a(){pui["client side timeout"]==true&&pui.qe.se.reset();pui.onuseractivity!=null&&pui.onuseractivity()}if(!pui.sc)if(!(pui.onuseractivity==null&&pui["client side timeout"]!=true)){addEvent(document.body,"keydown",a);addEvent(document.body,"mousemove",a);addEvent(document.body,"click",a);addEvent(document.body,"touchstart",a);addEvent(document.body,"touchmove",a);pui.sc=true}};pui.h={};pui.h.eb=(new Date).getTime();pui.h.W=false;pui.h.timeout=600;pui.h.bb=null;
pui.h.je=function(){if(pui.h.W)pui.h.reset();else if(pui["keep alive interval"]!=null){pui.h.timeout=pui["keep alive interval"];pui.h.start()}};pui.h.start=function(){if(!pui.h.W){var a=pui.h.timeout*1E3;a/=4;if(a>3E3)a=3E3;pui.h.bb=setInterval(pui.h.check,a);pui.h.reset();pui.h.W=true}};pui.h.stop=function(){if(pui.h.W){clearInterval(pui.h.bb);pui.h.W=false}};pui.h.reset=function(){pui.h.eb=(new Date).getTime()};
pui.h.check=function(){if((new Date).getTime()-pui.h.eb>=pui.h.timeout*1E3){pui.keepAlive();pui.h.reset()}};pui.Jd=function(a){if(!a)a=window.event;if(a.which!=null)if(a.which>1)return true;if(a.button!=null)if(a.button>1)return true;return false};
pui.ud=function(a){for(var d=0,c=0;a!=null;){d+=a.offsetLeft;c+=a.offsetTop;if(a.tagName!=="BODY"){d-=a.scrollLeft;c-=a.scrollTop}if(a.className=="scroller"){var e=a.style.transform;if(e==null)e=a.style.webkitTransform;if(e!=null&&typeof e=="string"&&e.substr(0,10)=="translate("){e=e.substr(10);e=e.split(")")[0];var f=e.split(",");e=f[0];f=f[1];if(e!=null&&f!=null){e=parseInt(trim(e));f=parseInt(trim(f));if(!isNaN(e)&&!isNaN(f)){d+=e;c+=f}}}}a=a.offsetParent}return[d,c]};
pui.sb=function(){this.yb=function(d){if(typeof d.length=="undefined")d=Array(d);for(var c,e=0;e<d.length;e++){c={};for(var f in d[e])c[f.toUpperCase()]=d[e][f];a.push(c)}};this.send=function(d,c){var e="",f,g,h;h=false;for(var j;!h;){f="ProfoundUIMIMEBoundary"+Math.ceil(1E9*Math.random());j=false;for(var l=0;l<a.length;l++){g=a[l].VALUE;if(g.indexOf(f)!=-1){j=true;break}}j||(h=true)}h=f;for(j=0;j<a.length;j++){f=a[j];if(!(typeof f.NAME!="string"||typeof f.VALUE!="string")){e+="--"+h+"\r\n";e+='Content-Disposition: form-data; name="'+
f.NAME+'"';if(typeof f.FILENAME=="string"){g="application/octet-stream";if(typeof f.CONTENTTYPE=="string")g=f.CONTENTTYPE;e+='; filename="'+f.FILENAME+'"\r\n';e+="Content-Type: "+g}if(f.TRANSFERENCODING!=null)e+="\r\nContent-Transfer-Encoding: "+f.TRANSFERENCODING;e+="\r\n\r\n";e+=f.VALUE;e+="\r\n"}}e+="--"+h+"--";f=new pui.Ajax(d);f.suppressAlert=true;f.async=true;f.method="POST";f.sendAsBinary=false;f.setRequestHeader("Content-Type","multipart/form-data; boundary="+h);f.postData=e;f.onready=c;f.send()};
var a=[]};pui.le=function(a){pui.Jc(b(a))};pui.Jc=function(a){a.ad=w(a)};pui.pd=function(a,d){for(var c=[],e=0,f="",g="",h=0,j=false,l=0;l<a.length;l++){if(d===true&&e==6){g=g.substr(0,g.length-6);break}f=a.charAt(l);if(j){if(f=="'")j=false}else{if(f=="("){h+=1;e=0}else if(f==")"){h-=1;e=0}else if(f=="'"){j=true;e=0}else if(h==0)if(f.toLowerCase()==" from ".charAt(e))e++;else e=0;if(h<1)h=0}if(f==","&&h==0&&!j){c.push(trim(g));g="";e=0}else g+=f}c.push(trim(g));return c};
pui.Ic={"database file":null,"database fields":null,"selection criteria":null,"order by":null,"custom sql":null,"name field":null,"value field":null,"summary option":null,"choices database file":null,"choice options field":null,"choice values field":null,"choices selection criteria":null,"parameter value":null,"choices parameter value":null,"case sensitive":null};pui.Kd=function(a){return typeof pui.Ic[a]!="undefined"};
pui.yd=function(a){var d=context+".",c=a.id;if(context=="genie"&&a.parentNode!=pui.uc)if(c.lastIndexOf("_W")!=-1)c=c.substr(0,c.lastIndexOf("_W")+2);d+=typeof a.parentNode.parentNode.grid=="undefined"||a.Bd?c:c.substr(0,c.lastIndexOf(".")+1)+"*";return d};
pui.xd=function(a,d){function c(){var n=pui.$b(),r=pui.ac();h+=j+"datfmt="+encodeURIComponent(n.va);h+="&datsep="+encodeURIComponent(n.Ea);h+="&timfmt="+encodeURIComponent(r.va);h+="&timsep="+encodeURIComponent(r.Ea);return h}var e=a["field type"]=="textbox",f=1,g="",h="",j="";g=/^(choices |blob )?(parameter value)( \d+)?/;var l="",k=1,o;for(var m in a){var q=g.exec(m);if(q){if(o==null)o=(q[1]?q[1]:"")+q[2];if(q[3]!=null)k=Math.max(k,parseInt(q[3],10))}}if(o==null)return c();do{g=evalPropertyValue(a[o+
l]);if(g!=""){m=f;if(e)m+=1;h+=j+"p"+m+"="+encodeURIComponent(g);j="&";if(d!=null)d["p"+m]=g}f++;l=" "+f}while(f<=k);return c()};pui.Id=function(a){if(a==null)return false;if(typeof a!="string")return false;if(a=="")return false;if(a.substr(a.length-1,1)=="%")return true;return false};pui.ic=function(a){if(a==null)return false;if(typeof a!="string")return false;var d=Number(a);if(isNaN(d))return false;if(String(d)===a)return true;return false};
pui.vd=function(a,d){if(a=="top"||a=="left"||a=="height"||a=="width")if(pui.ic(d))return d+"px";return d};pui.zd=function(){var a=0;if(typeof window.pageYOffset=="number")a=window.pageYOffset;else if(document.body&&document.body.scrollTop)a=document.body.scrollTop;else if(document.documentElement&&document.documentElement.scrollTop)a=document.documentElement.scrollTop;return a};
pui.td=function(a){var d=pui.getLanguageText("runtimeMsg","no connection message");if(pui["no connection status"]==true)d+="\n"+a.wa();if(pui.isCloud)if(a=a.N())d+="\n\nError details:\n"+a;return d};pui.$b=function(){var a=null,d=null;if(typeof pui["sql date format"]=="string")a=pui.tb[pui["sql date format"].toUpperCase()];if(a==null)a=pui.tb["*ISO"];if(typeof pui["sql date separator"]=="string")d=pui.ub[pui["sql date separator"].toUpperCase()];if(d==null)d=pui.ub["/"];return{va:a,Ea:d}};
pui.ac=function(){var a=null,d=null;if(typeof pui["sql time format"]=="string")a=pui.vb[pui["sql time format"].toUpperCase()];if(a==null)a=pui.vb["*ISO"];if(typeof pui["sql time separator"]=="string")d=pui.wb[pui["sql time separator"].toUpperCase()];if(d==null)d=pui.wb[":"];return{va:a,Ea:d}};pui.Wa=function(){var a=location.href.split("://"),d="",c="";if(a.length>1){d=a[0]+"://";a.splice(0,1);c=a.join("://")}else c=location.href;return c=d+c.split("/")[0]};
pui.qd=function(a){var d=document.getElementsByTagName("head")[0];if(d==null)return null;var c=pui.Wa();d=d.getElementsByTagName("link");for(var e=0;e<d.length;e++){var f=d[e];if(f.href==a)return f;if(f.href==c+a)return f}return null};pui.bc=function(a){var d=document.getElementsByTagName("head")[0];if(d==null)return null;var c=pui.Wa();d=d.getElementsByTagName("script");for(var e=0;e<d.length;e++){var f=d[e];if(f.src==a)return f;if(f.src==c+a)return f}return null};
pui.Vd=function(a){if(typeof a!="string")return a instanceof Array?a:[];if(a=="")return[];var d;if(a.substr(0,1)=="["&&a.substr(a.length-1,1)=="]")try{d=eval(a)}catch(c){}if(d==null)d=a.split(",");return d};pui.cb=function(a){switch(a){case "number":case "date":case "datetime":case "time":case "email":case "url":case "month":case "tel":case "url":case "color":case "datetime-local":case "search":case "week":return true;default:return false}};
pui.db=function(a){if(a.tagName=="INPUT")if(a.type==null||a.type==""||a.type=="text"||pui.cb(a.type)||a.type=="password")return true;return false};pui.Gd=function(a){a=a||window.event;var d=pui["field exit key"];return a.keyCode==d&&(!a.shiftKey||d==16)&&(!a.ctrlKey||d==17)?true:false};pui.Cd=function(a){a=a.parentNode;return a!=null&&(!pui.is_old_ie||a.nodeName!="#document-fragment")};
pui.Rc=function(a){if(!y()&&!pui.Sd&&typeof a=="string"&&a.search("AUTH=")==-1){a+=a.search(/\?/)==-1?"?":"&";a+="AUTH="+encodeURIComponent(pui.appJob.auth)}return a};pui.ue=function(a){return/^(([^<>()[\]\\.,;:\s@\"]+(\.[^<>()[\]\\.,;:\s@\"]+)*)|(\".+\"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/.test(a)};pui.Ed=function(a){return a!=null&&typeof a=="object"&&typeof a.fieldName=="string"};
pui.Md=function(a){return a!=null&&typeof a=="object"&&typeof a.translations=="object"&&a.translations!=null&&typeof a.translations.length=="number"};pui.oe=function(a,d,c){if(!(!pui.is_touch||!a||!a.addEventListener))if(typeof d=="function"){if(typeof c!="number")c=750;var e;a.addEventListener("touchstart",function(f){e=setTimeout(function(){e=null;d(f)},c)},false);a.addEventListener("touchend",function(){clearTimeout(e);e=null},false)}};
pui.jd=function(a){a.checked?a.setAttribute("checked","checked"):a.removeAttribute("checked")};pui.Nc=function(a){a=""+a;a=a.replace(/&/g,"&amp;");a=a.replace(/</g,"&lt;");a=a.replace(/>/g,"&gt;");return a=a.replace(/"/g,"&quot;")};pui.$=function(a){var d=false;try{d=typeof a.Atrium!="undefined"&&typeof a.Atrium.api!="undefined"}catch(c){}return d};pui.ve=function(a){var d=false;try{if(a.location.host!=null)d=true}catch(c){}return d};
pui.R=function(){try{return localStorage!=null&&typeof window.localStorage!="undefined"?true:false}catch(a){return false}};pui.Td=function(a){if(a.substr(0,1)=="#")a=a.toUpperCase();if(a.substr(0,4)=="rgb("&&a.substr(a.length-1,1)==")"){a=a.substr(4,a.length-5);a=a.replace(/ /g,"");var d=a.split(",");a="#";for(var c=0;c<d.length;c++){var e=Number(d[c]).toString(16).toUpperCase();if(e.length==1)e="0"+e;a+=e}}return a};
pui.Pd=function(a,d){var c;if(a.stack){c=a.toString();var e=a.stack.split("\n");if(e.length>=1)c+=c.indexOf(trim(e[0]))!=0||e.length<2?" "+trim(e[0]):" "+trim(e[1])}else{if(typeof d=="string")c=d;c+=" "+a.toString()}console.log(c)};pui.Wd=function(a){if(pui.is_chrome&&pui.db(a)){var d=a.value;a.value="";a.value=d}};
pui.gc=function(a,d){if(!(a===undefined||!a))if(!(a.tagName=="SPAN"&&a.className=="pui-highlight")){if(a.hasChildNodes())for(var c=0;c<a.childNodes.length;c++)pui.gc(a.childNodes[c],d);if(a.nodeType==3){var e=a.nodeValue;if(e!=null&&typeof e=="string"){for(c=e.toLowerCase();c.indexOf(String.fromCharCode(160))!=-1;)c=c.replace(String.fromCharCode(160)," ");c=c.indexOf(d.toLowerCase());if(c>=0){var f=e.substr(c,d.length);e=document.createElement("span");e.appendChild(document.createTextNode(f));e.className=
"pui-highlight";c=a.splitText(c);c.nodeValue=c.nodeValue.substring(d.length);a.parentNode.insertBefore(e,c)}}}}};pui.bd=function(a){for(a=a.getElementsByTagName("span");a.length&&(span=a[0]);){var d=span.parentNode;d.replaceChild(span.firstChild,span);d.normalize()}};
pui.ke=function(){if(!pui.is_mouse_capable)if(pui.R()&&localStorage["pui-is-mouse-capable"]=="true")pui.is_android||pui.is_ios||(pui.is_mouse_capable=true);else{var a=document.documentElement;if(a!=null){var d=function(){e=false},c=function(){if(e){if(pui.is_android||pui.is_ios){removeEvent(a,"mousedown",d);removeEvent(a,"mousemove",c);return}pui.is_mouse_capable=true;pui.R()&&localStorage.setItem("pui-is-mouse-capable","true");removeEvent(a,"mousedown",d);removeEvent(a,"mousemove",c)}e=true},e=false;
addEvent(a,"mousedown",d);addEvent(a,"mousemove",c)}}};pui.jc=function(){if(pui.is_chrome)for(var a=document.getElementsByTagName("iframe"),d=0;d<a.length;d++){var c=a[d],e=null;try{e=c.contentWindow.pui;c.contentWindow.puihalted=true}catch(f){}if(e!=null&&typeof e.unload==="function"){e.halted=true;e.unload()}else c.src=""}};
pui.haltFrames=function(){for(var a=document.getElementsByTagName("iframe"),d=0;d<a.length;d++){var c=a[d];if(c!=null){var e=null;try{e=c.contentWindow.pui;c.contentWindow.puihalted=true}catch(f){}if(e!=null&&typeof e==="object"){e.halted=true;typeof e.haltFrames==="function"&&e.haltFrames()}c.parentNode!=null&&c.parentNode.removeChild(c);c.src=""}}};
pui.breakMessagesInit=function(){if(!(y()||pui["brkmsg enable"]!==true))if(!(!pui.R()||typeof JSON!=="object"))if(!(typeof pui.e!=="object"||pui.e.user==null||pui.e.user.length<=0||pui.e.user==="QTMHHTP1")){pui["brkmsg poll interval"]=Number(pui["brkmsg poll interval"]);if(isNaN(pui["brkmsg poll interval"]))pui["brkmsg poll interval"]=30;else if(pui["brkmsg poll interval"]<1)pui["brkmsg poll interval"]=1;pui["brkmsg max errors"]=Number(pui["brkmsg max errors"]);if(isNaN(pui["brkmsg max errors"]))pui["brkmsg max errors"]=
3;pui["brkmsg max messages"]=Number(pui["brkmsg max messages"]);if(isNaN(pui["brkmsg max messages"]))pui["brkmsg max messages"]=10;pui["brkmsg user timeout"]=Number(pui["brkmsg user timeout"]);if(isNaN(pui["brkmsg user timeout"]))pui["brkmsg user timeout"]=300;else if(pui["brkmsg user timeout"]<=pui["brkmsg poll interval"])pui["brkmsg user timeout"]=pui["brkmsg poll interval"]+10;pui.Z=0;pui.Pa();var a;try{a=JSON.parse(localStorage.getItem("brkmsgMessages_"+pui.e.user))}catch(d){localStorage.setItem("brkmsgMessages_"+
pui.e.user,"[]")}if(window.parent==window||!pui.$(window.parent)){var c=document.createElement("div");c.id="pui-break-messages";c.style.zIndex=pui.pb++;pui.uc.appendChild(c);if(pui.R()){removeEvent(window,"storage",pui.ka);addEvent(window,"storage",pui.ka);a&&pui.Q(a)}}else{removeEvent(window.parent,"storage",window.parent.Atrium.api.breakMessagesOnStorage);addEvent(window.parent,"storage",window.parent.Atrium.api.breakMessagesOnStorage);a&&window.parent.Atrium.api.breakMessagesShow(a,pui.e.user)}pui.Bb()}};
pui.Pa=function(){if(!pui||!pui.e||pui.e.auth.length<=0||pui.e.user.length<=0)return false;var a=localStorage.getItem("brkmsgActivePoller_"+pui.e.user),d=Number(localStorage.getItem("brkmsgLastPoll_"+pui.e.user));if(isNaN(d))d=0;var c=Date.now();d=c-d;var e=pui["brkmsg poll interval"]*1E3+1E4;if(a===null||d>=e&&a!==pui.e.auth){a=pui.e.auth;localStorage.setItem("brkmsgActivePoller_"+pui.e.user,a);localStorage.setItem("brkmsgLastPoll_"+pui.e.user,c)}var f;c=false;try{f=JSON.parse(localStorage.getItem("brkmsgUserIds"))}catch(g){c=
true}if(f==null||typeof f.pop!=="function"){f=[];c=true}e=[];if(pui.Ma(f,pui.e.user)<0){e.push(pui.e.user);c=true}for(var h=0;h<f.length;h++)if(f[h]!==pui.e.user){d=Number(localStorage.getItem("brkmsgLastPoll_"+f[h]));if(isNaN(d))d=0;if(Date.now()-d>=pui["brkmsg user timeout"]*1E3){localStorage.removeItem("brkmsgLastPoll_"+f[h]);localStorage.removeItem("brkmsgActivePoller_"+f[h]);localStorage.removeItem("brkmsgMessages_"+f[h]);c=true}else e.push(f[h])}c&&localStorage.setItem("brkmsgUserIds",JSON.stringify(e));
return a===pui.e.auth};
pui.Bb=function(){if(!(y()||pui["brkmsg enable"]!==true)){typeof pui.ja==="number"&&clearInterval(pui.ja);pui.ja=setInterval(function(){if(typeof pui.e!=="object"||pui.e.user.length<=0||pui.e.user==="QTMHHTP1"||pui["brkmsg enable"]!==true)pui.la();else{if(pui.Pa()){B({url:getProgramURL("PUI0009116.PGM"),method:"post",async:true,suppressAlert:true,params:{AUTH:pui.e.auth},onfail:function(){pui.Z++;if(pui.Z>=pui["brkmsg max errors"]){pui.la();console.log("Stopped break-message polling; too many errors.")}},handler:function(c){if(c==
null||typeof c!=="object"||c.error){pui.Z++;pui.Z>=pui["brkmsg max errors"]&&pui.la()}else if(c.success&&c.messages!=null&&typeof c.messages.pop==="function"&&c.messages.length>0){var e;try{e=JSON.parse(localStorage.getItem("brkmsgMessages_"+pui.e.user))}catch(f){console.log(f)}if(e==null||typeof e.pop!=="function")e=[];e=e.concat(c.messages);if(pui["brkmsg max messages"]>0&&e.length>pui["brkmsg max messages"])e=e.slice(e.length-pui["brkmsg max messages"],e.length);if(window!=window.parent&&pui.$(window.parent))typeof window.parent.Atrium["brkmsg handler"]!==
"function"&&window.parent.Atrium.api.breakMessagesShow(e,pui.e.user);else pui.Q(e);localStorage.setItem("brkmsgMessages_"+pui.e.user,JSON.stringify(e))}}});localStorage.setItem("brkmsgLastPoll_"+pui.e.user,Date.now())}if(pui.R()&&typeof window.addEventListener==="undefined"&&typeof JSON==="object")try{var a=JSON.parse(localStorage.getItem("brkmsgMessages_"+pui.e.user));window!=window.parent&&pui.$(window.parent)?window.parent.Atrium.api.breakMessagesShow(a,pui.e.user):pui.Q(a)}catch(d){console.log(d)}}},
pui["brkmsg poll interval"]*1E3)}};pui.la=function(){clearInterval(pui.ja);removeEvent(window,"storage",pui.ka)};
pui.Oa=function(a){if(!(typeof pui.e!=="object"||pui.e.user.length<=0||pui.e.user==="QTMHHTP1")){v(a);if(!(a.keyCode&&a.keyCode!=13)){a=b(a).msgIdx;var d;try{d=JSON.parse(localStorage.getItem("brkmsgMessages_"+pui.e.user));if(d!==null&&typeof d.splice==="function"){if(!a&&a!=0)a=d.length-1;d.splice(a,1)}else d=[]}catch(c){console.log(c);d=[]}localStorage.setItem("brkmsgMessages_"+pui.e.user,JSON.stringify(d));pui.Q(d)}}};
pui.Q=function(a){if(typeof pui["brkmsg handler"]=="function")return pui["brkmsg handler"](a);pui.Ab=false;if(!(a==null||typeof a.pop!=="function")){var d=document.getElementById("pui-break-messages");if(d){d.innerHTML="";if(a.length==0)pui.unmaskScreen();else{pui.maskScreen();pui.Ab=true;pui.pb+=2;d.style.zIndex=pui.pb;for(var c=10,e=10,f=0;f<a.length;f++){var g=a[f];g.to=pui.e.user;var h=document.createElement("div");h.style.top=c+"px";h.style.left=e+"px";h.className="msg-wrap";var j=document.createElement("div");
j.className="msg-titlewrap";h.appendChild(j);var l=document.createElement("div");l.className="title";j.appendChild(l);var k=document.createElement("button");k.className="closeImg";k.msgIdx=f;j.appendChild(k);addEvent(k,"click",pui.Oa);addEvent(k,"keydown",pui.Oa);j=document.createElement("div");j.className="msg-body";if(typeof pui.breakMessageFormat==="function"){var o={title:"",body:""};pui.breakMessageFormat(g,o);l.innerHTML=o.title;j.innerHTML=o.body}else try{l.innerHTML=g.date+" "+g.time+"<br>"+
g.jobNum+"/"+g.jobUserName+"/"+g.jobName;j.innerHTML=g.to+":<br>"+g.msg}catch(m){console.log(m)}h.appendChild(j);d.appendChild(h);c+=1;e+=10}k.focus()}}}};pui.ka=function(a){if(typeof pui.e!=="object"||pui.e.user.length<=0||pui.e.user==="QTMHHTP1")return false;if(a.key!=="brkmsgMessages_"+pui.e.user)return false;try{var d=JSON.parse(a.newValue);pui.Q(d)}catch(c){console.log(c)}return false};
pui.me=function(a){if(pui["submit log"]){console.log("=".repeat(80));console.log((new Date).toString()+": submit flag = "+a);console.log("-".repeat(80));try{throw Error();}catch(d){a=d.stack.split("\n");a[0].indexOf("Error")==0&&a.shift();a.shift();for(var c=0;c<a.length;c++)a[c]!=""&&console.log(a[c].replace(/^\s*at\s/,""))}}};if(typeof String.prototype.repeat!="function")String.prototype.repeat=function(a){for(var d="",c=0;c<a;c++)d+=this;return d};
pui.wait=function(a,d,c,e){var f=0,g=setInterval(function(){f+=a;if(c()===true){clearInterval(g);e(true)}else if(f>=d){clearInterval(g);e(false)}},a)};
pui.La=function(a,d,c,e){if(a!=null){var f=a["field type"]||a.field_type;if(f!=null){if(f=="layout"&&a.template=="css panel")f="css panel";if(pui.Ha[f]!=null&&pui.Ha[f].dependencies!=null&&pui.Ha[f].dependencies.length>0){var g=["/FusionChartsXT/js/pui-fusioncharts.js"],h=document.getElementsByTagName("script"),j=document.getElementsByTagName("link");f=pui.Ha[f].dependencies;if(y()&&f.length>0)f=f.filter(function(r){if(g.indexOf(r)!==-1)return false;return true});var l="",k=document.URL.match(/^(https?:\/\/[^\/]+)\//i);
if(k!=null&&k.length==2)l=k[1];for(k=0;k<f.length;k++){var o=f[k],m=false;if(typeof f[k]=="object"&&f[k]!=null&&typeof f[k].condition=="function"){if(f[k].condition(a,c,e)){o=f[k].script;m=true}}else if(typeof f[k]=="string")m=true;if(m){o=pui.za(o);m=pui.za(l+o);for(var q=false,n=0;n<h.length;n++)if(h[n].type.toLowerCase()=="text/javascript"&&(h[n].src==m||h[n].src==o)){q=true;break}if(j&&!q)for(n=0;n<j.length;n++)if(j[n].type.toLowerCase()=="text/css"&&(j[n].href==m||j[n].href==o)){q=true;break}!q&&
pui.Ma(d,o)<0&&d.push(o)}}}}}};
pui.Od=function(a,d){function c(){if(pui.sa.length<=0){pui.sa=null;d()}else{var k=pui.sa.shift();if(k!=null&&k.length>0){var o=document.getElementsByTagName("head")[0],m,q=k.substr(-4,4).toLowerCase();if(q===".css"){m=document.createElement("link");m.setAttribute("type","text/css");m.setAttribute("rel","stylesheet")}else{m=document.createElement("script");m.setAttribute("type","text/javascript")}if(typeof m.onload=="undefined")m.onreadystatechange=function(){if(m.readyState=="complete"||m.readyState==
"loaded")c()};else{m.onload=c;m.onerror=function(n){n=n||window.event;if(n!=null&&n.target!=null)console.log("Failed to load widget dependency file ",n.target.src||n.target.href);c()}}q===".css"?m.setAttribute("href",k):m.setAttribute("src",k);o.appendChild(m)}else c()}}var e=[];if(a!=null)if(a.items!=null&&a.items.length>0)for(var f=0;f<a.items.length;f++)pui.La(a.items[f],e,null,a.designer);else if(a.layers!=null&&a.layers.length>0)for(var g=0;g<a.layers.length;g++){var h=a.layers[g];if(h!=null&&
h.formats!=null&&h.formats.length>0)for(var j=0;j<h.formats.length;j++){var l=h.formats[j];if(l!=null&&l.metaData!=null&&l.metaData.items!=null&&l.metaData.items.length>0)for(f=0;f<l.metaData.items.length;f++)pui.La(l.metaData.items[f],e,l.data,false)}}pui.sa=e;c()};pui.round=function(a,d){var c=Math.pow(10,d);return Math.round(a*c)/c};
pui.Ua=function(a){if(a.indexOf("<%")<0)return a;if(typeof window.ejs!=="object"||typeof window.ejs.render!=="function"){console.error("EJS templating library not loaded.");return a}if(pui.Va==null){var d={},c={},e=pui.layers;if(e==null)e=[];e=e[e.length-1];if(e==null)e={s:[]};e=e.s;for(var f=0;f<e.length;f++){var g=e[f];for(var h in g.data){var j=g.data[h];if(h.substr(0,3).toUpperCase()==="*IN"){var l=h.substr(3);isNaN(Number(l))||(l=Number(l));c[l]=j}else{d[h.toLowerCase()]=j;d[h.toUpperCase()]=
j;d[h]=j}}if(g.Ga)for(var k in g.Ga){j=g.Ga[k].data;for(var o=g.Ga[k]["field names"],m=[],q=0;q<j.length;q++){for(var n=j[q],r={},p=0;p<o.length;p++){l=o[p];if(l.substr(0,3).toUpperCase()==="*IN"){l=l.substr(3);isNaN(Number(l))||(l=Number(l));c[l]=n[p]}else{r[l.toLowerCase()]=n[p];r[l.toUpperCase()]=n[p];r[l]=n[p]}}m.push(r)}d[k.toLowerCase()]=m;d[k.toUpperCase()]=m;d[k]=m}}h=false;for(var s in c){h=true;break}if(h)d.kd=c;pui.Va=d}try{a=window.ejs.render(a,pui.Va)}catch(t){console.error(t)}return a};
pui.zc=function(a,d){if(pui.ua)setTimeout(function(){pui.zc(a,d)},100);else if(pui.Sb)a.innerHTML=pui.Ua(d);else{pui.ua=true;a.innerHTML="";pui.loadJS({path:pui.za("/ejs/ejs.min.js"),callback:function(){a.innerHTML=pui.Ua(d);pui.Sb=true;pui.ua=false},onerror:function(){pui.ua=false}})}};
pui.xe=function(){function a(){typeof saveAs=="function"||pui.bc(pui.za("/jszip/FileSaver.min.js"))!=null?d():pui.loadJS({path:"/jszip/FileSaver.min.js",callback:d,onerror:function(){console.log("Failed to load /jszip/FileSaver.min.js")}})}function d(){g?g.kc(c,j):c()}function c(){g&&l();var k=pui.I+'<Types xmlns="'+pui.qb+'/package/2006/content-types"><Default Extension="rels" ContentType="'+pui.mc+'-package.relationships+xml"/><Default Extension="xml" ContentType="application/xml"/>';if(g){var o=
g.Vb();for(var m in o)k+='<Default Extension="'+m+'" ContentType="'+o[m]+'"/>'}k+='<Override PartName="/xl/workbook.xml" ContentType="'+pui.T+'.sheet.main+xml"/><Override PartName="/xl/worksheets/sheet1.xml" ContentType="'+pui.T+'.worksheet+xml"/><Override PartName="/xl/styles.xml" ContentType="'+pui.T+'.styles+xml"/><Override PartName="/xl/sharedStrings.xml" ContentType="'+pui.T+'.sharedStrings+xml"/>';if(g!=null)k+='<Override PartName="/xl/drawings/drawing1.xml" ContentType="'+pui.mc+'-officedocument.drawing+xml"/>';
k+="</Types>";var q=pui.I+'<Relationships xmlns="'+pui.Ja+'"><Relationship Id="rId1" Type="'+pui.A+'/officeDocument" Target="xl/workbook.xml"/></Relationships>',n='<?xml version="1.0" encoding="UTF-8" standalone="yes"?><workbook xmlns="'+pui.Ka+'" xmlns:r="'+pui.A+'"><sheets><sheet name="Sheet1" sheetId="1" r:id="rId1"/></sheets></workbook>',r=pui.I+'<Relationships xmlns="'+pui.Ja+'"><Relationship Id="rId3" Type="'+pui.A+'/styles" Target="styles.xml"/><Relationship Id="rId1" Type="'+pui.A+'/worksheet" Target="worksheets/sheet1.xml"/><Relationship Id="rId4" Type="'+
pui.A+'/sharedStrings" Target="sharedStrings.xml"/></Relationships>',p=pui.I+'<styleSheet xmlns="'+pui.Ka+'"><fonts count="2"><font><sz val="11"/><color theme="1"/><name val="Calibri"/><family val="2"/><scheme val="minor"/></font><font><u/><sz val="11"/><color rgb="0563C1"/><name val="Calibri"/><family val="2"/><scheme val="minor"/></font></fonts><fills count="1"><fill><patternFill patternType="none"/></fill></fills><borders count="1"><border><left/><right/><top/><bottom/><diagonal/></border></borders><cellStyleXfs count="2"><xf numFmtId="0" fontId="0" fillId="0" borderId="0"/><xf numFmtId="0" fontId="1" fillId="0" borderId="0"/></cellStyleXfs><cellXfs count="3"><xf numFmtId="0" fontId="0" fillId="0" borderId="0" xfId="0"/><xf numFmtId="2" fontId="0" fillId="0" borderId="0" xfId="0" applyNumberFormat="1"/><xf numFmtId="0" fontId="1" fillId="0" borderId="0" xfId="1"/></cellXfs><dxfs count="0"/></styleSheet>',
s;if(g||h){s=pui.I+'<Relationships xmlns="'+pui.Ja+'">';if(g)s+='<Relationship Id="rId1" Type="'+pui.A+'/drawing" Target="../drawings/drawing1.xml"/>';if(h!=null&&h.length>0)for(o=0;o<h.length;o++)s+='<Relationship Id="rId'+(o+2)+'" Type="'+pui.A+'/hyperlink" Target="'+h[o].target+'" TargetMode="External"/>';s+="</Relationships>"}m=new JSZip;m.file("[Content_Types].xml",k);m.file("_rels/.rels",q);m.file("xl/workbook.xml",n);m.file("xl/styles.xml",p);m.file("xl/sharedStrings.xml",f.cc());m.file("xl/_rels/workbook.xml.rels",
r);m.file("xl/worksheets/sheet1.xml",f.dc());if(g||h){m.file("xl/worksheets/_rels/sheet1.xml.rels",s);if(g){m.file("xl/drawings/drawing1.xml",g.Ub());m.file("xl/drawings/_rels/drawing1.xml.rels",g.Tb());k=g.Xb();for(o=0;o<k.length;o++)k[o].ab&&m.file("xl/media/"+k[o].name,k[o].ab,{binary:true})}}if(typeof Blob!="function"){k=m.generateAsync({type:"base64",compression:"DEFLATE"});k.then(function(t){pui.Qb(pui.T+".sheet",e+".xlsx",t)})}else{k=m.generateAsync({type:"blob",compression:"DEFLATE",mimeType:pui.T+
".sheet"});k.then(function(t){saveAs(t,e+".xlsx")})}}var e="sheet",f,g,h,j,l;this.he=function(k){e=k};this.ie=function(k){f=k};this.fe=function(k){g=k};this.Ac=function(k){h=k};this.be=function(k,o){j=k;l=o};this.cd=function(){typeof JSZip=="function"?a():pui.loadJS({path:"/jszip/jszip.min.js",callback:a,onerror:function(){console.log("Failed to load /jszip/jszip.min.js")}})}};
pui.ye=function(a){var d=this,c=null,e={},f=0,g=20,h=[],j=0,l=false,k,o=[];this.s=[];for(var m=0;m<a;m++)d.s[m]={dataType:"char"};var q=[];(function(){for(var n=0,r="",p="",s=-1;s<26&&n<a;s++){var t=-1;if(s>=0)t=0;for(t=t;t<26&&n<a;t++){for(var u=0;u<26&&n<a;u++){o[n]=r+p+"ABCDEFGHIJKLMNOPQRSTUVWXYZ"[u];n++}p="ABCDEFGHIJKLMNOPQRSTUVWXYZ"[(t+1)%26]}r="ABCDEFGHIJKLMNOPQRSTUVWXYZ"[s+1]}})();this.Rd=function(){if(c==null)c=[];c.push([]);j=0};this.md=function(){if(c==null)return-1;return c.length-1};this.ee=
function(n){g=n};this.de=function(n){h=n};this.ce=function(n,r){if(r.dataType!=null)if(r.dataType.length==1){var p="char";switch(r.dataType){case "L":p="date";break;case "T":p="time";break;case "Z":p="timestamp";break;case "G":p="graphic";break;case "F":p="floating";break;case "P":p="packed";break;case "B":case "I":case "S":case "U":case "Y":p="zoned";break}d.s[n].dataType=p}else d.s[n].dataType=r.dataType;if(r.decPos!=null)d.s[n].decPos=r.decPos};this.Pc=function(n,r){var p=j;d.xc(j,n,r);j++;return p};
this.te=function(){l=true};this.Ac=function(n){k=n};this.xc=function(n,r,p){q[n]=c.length==1?r.length:Math.max(q[n],r.length);var s=d.s[n].dataType;if(p!=null)s=p;if(s=="char"||s=="varchar"||s=="graphic"||s=="date"||s=="timestamp"||s=="time"){if(e[r]==null)e[r]=f++;r=e[r]}if(p!=null&&p!=d.s[n].dataType)r={value:r,format:p};c[c.length-1][n]=r};this.cc=function(){var n=[];for(var r in e)n[e[r]]=r;r=pui.I+'<sst xmlns="'+pui.Ka+'" count="'+String(n.length+1)+'"  uniqueCount="'+String(n.length)+'">';for(var p=
0;p<n.length;p++)r+="<si><t>"+pui.Nc(n[p])+"</t></si>";r+="</sst>";return r};this.dc=function(){var n=pui.I+'<worksheet xmlns="'+pui.Ka+'" xmlns:r="'+pui.A+'"><dimension ref="A1:'+o[a-1]+(c==null?1:c.length)+'"/><sheetFormatPr defaultRowHeight="'+g*0.75+'" customHeight="1" /><cols>',r={};if(k!=null&&k.length>0)for(var p=0;p<k.length;p++){var s=k[p].fa,t=k[p].aa;if(r[s]==null)r[s]={};r[s][t]=true}for(p=0;p<a;p++){s=0;if(h[p]!=null)s=pui.round((h[p]-5)/7,2);else if(q[p]!=null&&!isNaN(parseInt(q[p],
10)))s=Math.floor((q[p]*7+5)/7*256)/256+5;if(s<0)s=0;else if(s>255)s=255;n+='<col min="'+(p+1)+'" max="'+(p+1)+'" width="'+s+'" '+(d.s[p].decPos=="2"?'s="1"':"")+' customWidth="1"/>'}n+="</cols><sheetData>";if(c!=null)for(t=0;t<c.length;t++){s=String(t+1);n+='<row r="'+s+'">';for(p=0;p<a;p++){n+='<c r="'+o[p]+s+'"';var u=d.s[p].dataType;if(typeof c[t][p]=="object"&&c[t][p].format!=null){u=c[t][p].format;c[t][p]=c[t][p].value}if(u=="char"||u=="varchar"||u=="graphic"||u=="date"||u=="timestamp"||u==
"time"){n+=' t="s"';if(r[t]!=null&&r[t][p]===true)n+=' s="2"'}else if(d.s[p].decPos=="2")n+=' s="1"';if(c[t][p]==null)c[t][p]="";n+="><v>"+c[t][p]+"</v></c>"}n+="</row>"}n+="</sheetData>";if(l)n+='<drawing r:id="rId1"/>';if(k!=null&&k.length>0){n+="<hyperlinks>";for(p=0;p<k.length;p++){s=k[p].fa+1;n+='<hyperlink ref="'+o[k[p].aa]+s+'" r:id="rId'+(p+2)+'" />'}n+="</hyperlinks>"}n+="</worksheet>";return n}};
pui.we=function(){var a=1,d={},c=[],e=[];this.Qc=function(f,g,h,j){var l=h.match(/\.(jpe?g|gif|png|tiff?)(\?.*)?(#.*)?$/i);if(l==null)console.log("Unsupported image type in URI:",h);else{l=l[1].toLowerCase();if(l=="jpeg")l="jpg";else if(l=="tif")l="tiff";for(var k=-1,o=0;o<c.length;o++)if(c[o].uri==h){k=o;break}if(k<0){k="image"+a+"."+l;a++;d[l]="image/"+l;c.push({name:k,uri:h});k=c.length-1}e.push({fa:f,aa:g,rel:k,top:j.top,left:j.top,width:j.width,height:j.height})}};this.Ub=function(){for(var f=
pui.I+'<xdr:wsDr xmlns:xdr="'+pui.qb+'/drawingml/2006/spreadsheetDrawing" xmlns:a="'+pui.qb+'/drawingml/2006/main">',g=0;g<e.length;g++)f+='<xdr:twoCellAnchor editAs="oneCell"><xdr:from><xdr:col>'+e[g].aa+"</xdr:col><xdr:colOff>"+Math.round(e[g].left*9525)+"</xdr:colOff><xdr:row>"+e[g].fa+"</xdr:row><xdr:rowOff>"+Math.round(e[g].top*9525)+"</xdr:rowOff></xdr:from><xdr:to><xdr:col>"+e[g].aa+"</xdr:col><xdr:colOff>"+Math.round((e[g].width+e[g].left)*9525)+"</xdr:colOff><xdr:row>"+e[g].fa+"</xdr:row><xdr:rowOff>"+
Math.round((e[g].height+e[g].top)*9525)+'</xdr:rowOff></xdr:to><xdr:pic><xdr:nvPicPr><xdr:cNvPr id="'+(g+1)+'" name="Picture '+(g+1)+'"/><xdr:cNvPicPr><a:picLocks noChangeAspect="1" noChangeArrowheads="1"/></xdr:cNvPicPr></xdr:nvPicPr><xdr:blipFill><a:blip xmlns:r="'+pui.A+'" r:embed="rId'+(e[g].rel+1)+'"></a:blip><a:srcRect/><a:stretch><a:fillRect/></a:stretch></xdr:blipFill><xdr:spPr bwMode="auto"><a:xfrm></a:xfrm><a:prstGeom prst="rect"><a:avLst/></a:prstGeom><a:noFill/></xdr:spPr></xdr:pic><xdr:clientData/></xdr:twoCellAnchor>';
f+="</xdr:wsDr>";return f};this.Tb=function(){for(var f=pui.I+'<Relationships xmlns="'+pui.Ja+'">',g=0;g<c.length;g++)f+='<Relationship Id="rId'+(g+1)+'" Type="'+pui.A+'/image" Target="../media/'+c[g].name+'"/>';f+="</Relationships>";return f};this.kc=function(f,g){function h(){j++;g(pui.getLanguageText("runtimeMsg","downloading x",[Math.round(100*(j/c.length))+"%"]));if(!(j<c.length)){for(var k=0;k<c.length;k++){if(c[k].H.status==200)c[k].ab=c[k].H.response;c[k].H=null;try{delete c[k].H}catch(o){}}f()}}
if(c.length<1)f();else for(var j=0,l=0;l<c.length;l++){c[l].H=new XMLHttpRequest;c[l].H.open("GET",c[l].uri,true);c[l].H.responseType="blob";c[l].H.onload=h;c[l].H.send()}};this.Xb=function(){return c};this.Vb=function(){return d}};
pui.od=function(a,d){var c=a.library||"",e=a.file||"",f=a.customSql||"";if(context=="genie")url=getProgramURL("PUI0009101.PGM");if(context=="dspf")url=getProgramURL("PUI0009101.PGM",null,true);var g=new pui.Ajax(url);g.async=true;g.method="post";g.postData="file="+encodeURIComponent(e);g.postData+="&library="+encodeURIComponent(c);g.postData+="&customSql="+encodeURIComponent(f);if(pui.isCloud)g.postData+="&workspace_id="+pui.na.Ia.id;console.log(g.postData);if(context=="genie")g.postData+="&AUTH="+
GENIE_AUTH;g.postData+="&context="+context;g.suppressAlert=true;g.onready=function(){d(g)};g.send()};pui.fd=function(a){var d=null;if(errors.length>0){d=errors.length-1;d={operation:errors[d].Ud,id:errors[d].id,text:errors[d].text,text2:errors[d].pe}}try{pui.temporary_property=d;eval("var response = { success: arguments[1], id: arguments[2], error: pui.temporary_property };");var c=eval(a);typeof c=="function"&&c()}catch(e){pui.wc(e,"OndbLoad Error:\n");return false}return true};
pui.wc=function(a,d){if(pui["alert script errors"]===false){if(window.console&&window.console.error){if(a.stack){var c=a.stack.split("\n");c[0]!=a.toString()&&c.splice(0,0,a.toString());c=c.join("\n")}else c=a.toString();if(d!=null)c=d+c;console.error(c)}}else{c=a.message;if(d!=null)c=d+c;pui.alert(c)}};
pui.Xd=function(){["pui-material-icons","pui-fa-icons","blueprint-defaults","office-copy-defaults"].forEach(function(a){var d=document.createElement("div");d.innerText="face";d.className=a;d.style.visibility="hidden";d.style.left="-1000px";d.style.position="absolute";document.body.appendChild(d)})};
pui.gd=function(){pui.useAceEditor||pui.is_ie||pui.ie_mode<=11||["profoundjs.d.ts","profoundui.d.ts"].forEach(function(a){var d=new pui.Ajax("/profoundui/proddata/typings/"+a);d.async=true;d.headers={"Content-Type":"text/plain"};d.overrideMimeType="text/plain";d.suppressAlert=true;d.onsuccess=function(c){if(c=c.getResponseText())if(!(!window.monaco||pui.useAceEditor)){window.monaco.languages.typescript.javascriptDefaults.addExtraLib(c,a);window.monaco.languages.typescript.typescriptDefaults.addExtraLib(c,
a)}};d.onfail=function(c){console.error(c.getStatusMessage())};d.send()})};pui.nd=function(){return[{type:"material",title:"Material Icons",classList:{"":"pui-material-icons"}},{type:"fontAwesome",title:"Font Awesome Icons",classList:{brands:"pui-fa-brands-icons fa-",solid:"pui-fa-solid-icons fa-",regular:"pui-fa-regular-icons fa-"}},{type:"jQueryIcons",title:"jQuery Mobile Icons",classList:{"":"ui-icon ui-icon-"}}]};pui.Zd=function(){return Math.random().toString(36).replace(/[^a-z]+/g,"")};
pui.Qd=function(a){function d(m){v(m);g=pui.rd(m);h=pui.sd(m);j=a.move.offsetLeft;l=a.move.offsetTop;if(typeof a.opacity==="number"){a.move.style.filter="alpha(opacity="+a.opacity+")";a.move.style.opacity="0."+a.opacity}addEvent(document,"mousemove",k);addEvent(document,"mouseup",f)}function c(m){m=pui.Zb(m);if(m.x<a.S)m.x=a.S;if(m.y<a.X)m.y=a.X;if(typeof a.U==="number"&&m.x>a.U)m.x=a.U;if(typeof a.P==="number"&&m.y>a.P)m.y=a.P;a.move.style.left=j-g+m.x+"px";a.move.style.top=l-h+m.y+"px";typeof a.Pb===
"function"&&a.Pb()}function e(m){var q=pui.Zb(m);m=j+q.x-g;q=l+q.y-h;if(m<a.S)m=a.S;if(q<a.X)q=a.X;if(typeof a.U==="number"&&m>a.U)m=a.U;if(typeof a.P==="number"&q>a.P)q=a.P;a.move.style.left=m+"px";a.move.style.top=q+"px";typeof a.oc==="function"&&a.oc()}function f(){removeEvent(document,"mousemove",k);removeEvent(document,"mouseup",f);typeof a.Kc==="function"&&a.Kc();if(typeof a.opacity==="number"){a.move.style.filter="";a.move.style.opacity=""}}var g,h,j,l;if(typeof a.S!=="number")a.S=0;if(typeof a.X!==
"number")a.X=0;var k=a.Vc==="click"?c:e;if(a.Y instanceof Array)for(var o=0;o<a.Y.length;o++)addEvent(a.Y[o],"mousedown",d);else a.Y!=null&&addEvent(a.Y,"mousedown",d)};pui.Lc=function(a){if(window.React&&a!=null&&a.C&&a.C.data&&a.C.ca){var d={};d[a.C.ca]=[a];d=pui.Wc(d);a.C.data[a.C.ca]=d[a.C.ca]}};
pui.Bc=function(a,d){if(context=="dspf"){if(pui.ae){var c=b(a);c.modified=true;if(c.parentNode!=null&&c.parentNode.Ra!=null){c=c.parentNode;c.modified=true}pui.modified=true;if(c.id!=null&&c.id.indexOf(".")==-1&&d)pui.$c[d]=true;window.React&&c.C.data&&c.C.ca&&setTimeout(function(){pui.Lc(c)},0)}}else if(pui.J.rendered){c=b(a);if(c!=null){var e=c.hd;if(e!=null){e=e.idx;if(e!=null){e=String(e);if(c.fc!=null)e="s"+e+"."+c.fc;pui.response[e]=c;if(c.type=="radio"&&pui.genie.allowRadioClear&&c.className.indexOf("selection-field-single")>=
0)if(a.type=="click")setTimeout(function(){if(pui.ie_mode==8&&c.checked!=c.Yd)c.ya=true;if(c.checked&&!c.ya)c.checked=false;c.ya=false},0);else if(a.type=="change")c.ya=true}}}}};
pui.ed=function(a){a=a||window.event;if(a.keyCode==pui.dup.keyCode)if(!(pui.dup.shift&&!a.shiftKey))if(!(pui.dup.ctrl&&!a.ctrlKey))if(!(pui.dup.alt&&!a.altKey)){var d=b(a),c=d.value,e=d.maxLength;if(e==null)e=0;e=Number(e);if(isNaN(e))e=0;var f=w(d);if(f<0)f=0;for(c=c.substr(0,f);c.length<f;)c+=" ";for(;c.length<e;)c+=pui.dup["char"];d.value=c;pui.Bc(a);pui.Ad(d);v(a);return false}};
pui.Fd=function(a){var d="";if(typeof a=="string")d=a;if(typeof a=="object")d=a.value;if(d==null)d="";if(typeof d!="string")d=String(d);return d.indexOf(pui.dup["char"])!=-1};function C(a){this.onready=this.onfail=this.onsuccess=this.suppressAlert=this.password=this.user=this.async=this.url=this.reqData=this.postData=this.method=null;this.headers={};this.params=null;this.sendAsBinary=true;var d=this.overrideMimeType=null,c=null,e=null,f=null,g=typeof pui!="undefined"&&typeof pui.alert!="undefined"?pui.alert:alert,h=this;if(typeof a=="object")for(var j in a){if(typeof this[j]!="undefined")this[j]=a[j]}else this.url=a;if(window.XMLHttpRequest)d=new XMLHttpRequest;else if(window.Oc)d=
new ActiveXObject("Microsoft.XMLHTTP");else{g("Ajax request error: Unsupported browser.");return}this.send=this.send=function(){function l(){if(d.readyState==4){c=d.status+" - "+d.statusText;h.onready!=null&&h.onready(h);if(d.status==200){e=true;h.onsuccess!=null&&h.onsuccess(h)}else{e=false;h.suppressAlert!=true&&g(c);h.onfail!=null&&h.onfail(h)}f=false}}var k=null,o=null,m=null;if(h.method==null)k="GET";else if(typeof h.method!="string"&&(h.method.toUpperCase()!="GET"||h.method.toUpperCase()!="POST"||
h.method.toUpperCase()!="PUT")){g('Invalid value for property: "method".');return}else k=h.method.toUpperCase();if(k=="POST"||k=="PUT"){if(h.reqData!=null)m=h.reqData;else if(h.postData!=null)m=h.postData;if(m!=null){if(typeof m!="string"){g('Invalid value for property: "postData".');return}}else m=""}if(h.async==null)o=true;else if(h.async!=true&&h.async!=false){g('Invalid value for property: "async".');return}else o=h.async;if(typeof h.url!="string")g('Invalid value for property: "url".');else{if(h.user!=
null)if(typeof h.user!="string"){g('Invalid value for property: "user".');return}if(h.password!=null)if(typeof h.password!="string"){g('Invalid value for property: "password".');return}if(h.onsuccess!=null)if(typeof h.onsuccess!="function"){g('Invalid value for event: "onsuccess".');return}if(h.onfail!=null)if(typeof h.onfail!="function"){g('Invalid value for event: "onfail".');return}if(h.onready!=null)if(typeof h.onready!="function"){g('Invalid value for event: "onready".');return}var q=true;if(m!=
null)for(var n in h.headers)if(n.toUpperCase()=="CONTENT-TYPE")if(h.headers[n].toLowerCase().indexOf("www-form-urlencoded")==-1)q=false;var r=h.url,p=h.params;if(typeof p=="object"){var s="";for(n in p){var t=p[n],u=[];if(typeof t=="object"){if(t.length!=null&&t.length>0)u=t}else u.push(t);for(t=0;t<u.length;t++){if(s!="")s+="&";s+=encodeURIComponent(n)+"="+encodeURIComponent(u[t])}}if(s!="")if(q&&(k=="POST"||k=="PUT")){if(m!=null&&m!="")m+="&";else m="";m+=s}else{q=r.split("?");if(q.length==2&&q[1]!=
"")r=q[0]+"?"+q[1]+"&"+s;else r+="?"+s}}try{typeof h.user=="string"&&typeof h.password=="string"?d.open(k,r,o,h.user,h.password):d.open(k,r,o);r=false;var x=h.headers;for(n in x){d.setRequestHeader(n,x[n]);if(n.toUpperCase()=="CONTENT-TYPE")r=true}if(k=="POST")r||d.setRequestHeader("Content-type","application/x-www-form-urlencoded");typeof h.overrideMimeType=="string"&&typeof d.overrideMimeType=="function"&&d.overrideMimeType(h.overrideMimeType)}catch(A){g(A);return}f=true;if(o==true)d.onreadystatechange=
l;if(h.sendAsBinary==true)try{d.sendAsBinary(m)}catch(F){d.send(m)}else d.send(m);o!=true&&l()}};this.ok=this.rc=function(){return e!=null?e:false};this.getResponseText=this.N=function(){return d.responseText};this.getResponseXML=this.Ya=function(){return d.responseXML};this.getStatus=this.Za=function(){return d.status};this.getStatusText=this.ec=function(){return d.statusText};this.getStatusMessage=this.wa=function(){return c};this.getAllResponseHeaders=this.getAllResponseHeaders=function(){if(e)try{return d.getAllResponseHeaders()}catch(l){g(l)}};
this.getResponseHeader=this.getResponseHeader=function(l){if(e)try{return d.getResponseHeader(l)}catch(k){g(k)}};this.setRequestHeader=this.setRequestHeader=function(l,k){h.headers[l]=k};this.abort=this.abort=function(){if(!(f==null||f==true))try{d.abort()}catch(l){g(l)}}}
function z(a,d){var c,e,f,g="";if(arguments.length==1&&typeof arguments[0]=="object"){c=arguments[0];c.async=null;c.onsuccess=null;if(typeof c.handler=="function"){e=true;f=c.handler}else e=false}else if(d!=null&&typeof d=="function"){e=true;f=d}else e=false;c=new C(arguments[0]);c.async=e;c.onsuccess=function(h){g+=h.N();e==true&&f(g)};c.send();if(e==false)return g}
function B(a,d){var c,e,f,g=null,h=false;if(arguments.length==1&&typeof arguments[0]=="object"){c=arguments[0];c.async=null;c.onsuccess=null;if(c.saveResponse==true)h=true;if(typeof c.handler=="function"){e=true;f=c.handler}else e=false}else if(d!=null&&typeof d=="function"){e=true;f=d}else e=false;c=new C(arguments[0]);c.async=e;c.onsuccess=function(j){j=j.N();if(h&&typeof pui=="object")pui.savedJSON=j;try{g=eval("("+j+")")}catch(l){f(null,l);return}e==true&&f(g)};c.send();if(e==false)return g}
if(typeof window.pui=="undefined")window.pui={};window.RPGspRequest=C;window.pui.Ajax=C;window.pui.AjaxRequest=C;window.ajax=z;
window.ajaxXML=function(a,d){var c,e,f,g=null;if(arguments.length==1&&typeof arguments[0]=="object"){c=arguments[0];c.async=null;c.onsuccess=null;c.onfail=null;c.onsuccess=null;if(typeof c.handler=="function"){e=true;f=c.handler}else e=false}else if(d!=null&&typeof d=="function"){e=true;f=d}else e=false;c=new C(arguments[0]);c.async=e;c.onsuccess=function(h){g=h.Ya();e==true&&f(g)};c.send();if(e==false)return g};window.ajaxJSON=B;
window.ajaxSubmit=function(a,d){var c,e="",f=typeof pui!="undefined"&&typeof pui.alert!="undefined"?pui.alert:alert;if(typeof a=="object")c=a;else{c=document.getElementById(a);if(c==null)c=document.forms[a]}var g;if(c!=null)g=c.tagName;if(c==null||g==null||g.toUpperCase()!="FORM"){f("Ajax request error: Invalid form object.");return""}if(a.action==""){f("Ajax request error: Invalid form action.");return""}for(f=0;f<c.elements.length;f++){g=c.elements[f];if(g.name!=null&&g.name!=""){var h=false;if(g.tagName==
"INPUT"){var j=g.type;j=j.toLowerCase();if(j=="hidden")h=true;if(j=="password")h=true;if(j=="text")h=true;if(pui.cb(j))h=true;if(j=="")h=true;if(j=="checkbox"||j=="radio")if(g.checked)h=true}if(g.tagName=="TEXTAREA")h=true;if(g.tagName=="SELECT")h=true;if(h){if(e!="")e+="&";e+=g.name+"="+encodeURIComponent(g.value)}}}c=new C(c.action);c.method="POST";c.postData=e;var l="",k;if(d!=null&&typeof d=="function")k=true;else{k=false;c.async=false}c.onsuccess=function(o){l+=o.N();k==true&&d(l)};c.send();
if(k==false)return l};pui.rb=function(){var a=this,d=[];this.Yb=function(){return d};this.add=function(c){var e=c.name;if(e!==null){for(var f=0;f<d.length;f++)if(c.text<d[f].text)break;d.splice(f,0,c);a[e]=c}}};pui.r=new pui.rb;pui.r.add({name:"en_UK",text:"English (United Kingdom)",datePatterns:["Y-m-d","d.m.y","d.m.Y","d/m/y","d/m/Y","d-m-y","d-m-Y","Y/m","Y/m/d","y/m/d","j F y","j F Y","l j F y","l j F Y","D d M y","D d M Y","j-M-y","j-M-Y","j M y","j M Y","yz","y/z","y-z","y.z","Yz","Y/z","Y-z","Y.z"],timePatterns:["g:i","g:i:s","g:i a","g:i A","H:i","H.i.s","H:i:s","H:i a","H:i A","g:i:s a","g:i:s A","H:i:s a","H:i:s A"],timeStampPatterns:["D d M Y H:i:s","d.m.y g:i A","d.m.y g:i a","d.m.y H:i:s","d/m/y g:i A","d/m/y g:i a",
"d/m/y H:i:s","d-m-y g:i A","d-m-y g:i a","d-m-y H:i:s","g:i A o\\n n/j/y","Y-m-d-H.i.s.uu"],monthNames:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonthNames:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],dayNames:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDayNames:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],weekStart:1});pui.r.add({name:"en_US",text:"English (United States)",datePatterns:["Y-m-d","m/d/y","m/d/Y","n/j/y","n/j/Y","m-d-y","m-d-Y","n-j-y","n-j-Y","Y/m","m/Y","Y/m/d","y/m/d","l, F j, Y","l, F jS, Y","D, M d, y","D, M d, Y","D M d y","D M d Y","F j, y","F j, Y","M j, y","M j, Y","j-M-y","j-M-Y","yz","y/z","y-z","Yz","Y/z","Y-z"],timePatterns:["g:i","g:i:s","g:i a","g:i A","H:i","H.i.s","H:i:s","H:i a","H:i A","g:i:s a","g:i:s A","H:i:s a","H:i:s A"],timeStampPatterns:["m/d/y g:i A","m/d/y g:i a","m/d/y H:i:s",
"m-d-y g:i A","m-d-y g:i a","m-d-y H:i:s","D, M d, Y H:i:s","g:i A o\\n n/j/y","Y-m-d-H.i.s.uu"],monthNames:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonthNames:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],dayNames:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDayNames:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],weekStart:0});pui.r.add({name:"fr_FR",text:"French (France)",datePatterns:["Y-m-d","d.m.y","d.m.Y","d/m/y","d/m/Y","d-m-y","d-m-Y","Y/m","Y/m/d","y/m/d","j F y","j F Y","l j F y","l j F Y","D d M y","D d M Y","j-M-y","j-M-Y","j M y","j M Y","yz","y/z","y-z","y.z","Yz","Y/z","Y-z","Y.z"],timePatterns:["g:i","g:i:s","g:i a","g:i A","H:i","H.i.s","H:i:s","H:i a","H:i A","g:i:s a","g:i:s A","H:i:s a","H:i:s A"],timeStampPatterns:["D d M Y H:i:s","d.m.y g:i A","d.m.y g:i a","d.m.y H:i:s","d/m/y g:i A","d/m/y g:i a",
"d/m/y H:i:s","d-m-y g:i A","d-m-y g:i a","d-m-y H:i:s","Y-m-d-H.i.s.uu"],monthNames:["janvier","f\u00e9vrier","mars","avril","mai","juin","juillet","ao\u00fbt","septembre","octobre","novembre","d\u00e9cembre"],shortMonthNames:["jan","f\u00e9v","mar","avr","mai","jun","jui","ao\u00fb","sep","oct","nov","d\u00e9c"],dayNames:["dimanche","lundi","mardi","mercredi","jeudi","vendredi","samedi"],shortDayNames:["dim","lun","mar","mer","jeu","ven","sam"],weekStart:1});pui.r.add({name:"de_DE",text:"German (Germany)",datePatterns:["Y-m-d","d.m.y","d.m.Y","d/m/y","d/m/Y","d-m-y","d-m-Y","Y/m","Y/m/d","y/m/d","j F y","j F Y","l j F y","l j F Y","D d M y","D d M Y","j-M-y","j-M-Y","j M y","j M Y","yz","y/z","y-z","y.z","Yz","Y/z","Y-z","Y.z"],timePatterns:["g:i","g:i:s","g:i a","g:i A","H:i","H.i.s","H:i:s","H:i a","H:i A","g:i:s a","g:i:s A","H:i:s a","H:i:s A"],timeStampPatterns:["D d M Y H:i:s","d.m.y g:i A","d.m.y g:i a","d.m.y H:i:s","d/m/y g:i A","d/m/y g:i a",
"d/m/y H:i:s","d-m-y g:i A","d-m-y g:i a","d-m-y H:i:s","Y-m-d-H.i.s.uu"],monthNames:["Januar","Februar","M\u00e4rz","April","Mai","Juni","Juli","August","September","Oktober","November","Dezember"],shortMonthNames:["Jan","Feb","M\u00e4r","Apr","Mai","Jun","Jul","Aug","Sep","Okt","Nov","Dez"],dayNames:["Sonntag","Montag","Dienstag","Mittwoch","Donnerstag","Freitag","Samstag"],shortDayNames:["So","Mo","Di","Mi","Do","Fr","Sa"],weekStart:1});pui.r.add({name:"pt_BR",text:"Portuguese (Brazil)",datePatterns:["Y-m-d","d.m.y","d.m.Y","d/m/y","d/m/Y","d-m-y","d-m-Y","Y/m","Y/m/d","y/m/d","j F y","j F Y","l j F y","l j F Y","D d M y","D d M Y","j-M-y","j-M-Y","j M y","j M Y","yz","y/z","y-z","y.z","Yz","Y/z","Y-z","Y.z"],timePatterns:["g:i","g:i:s","g:i a","g:i A","H:i","H.i.s","H:i:s","H:i a","H:i A","g:i:s a","g:i:s A","H:i:s a","H:i:s A"],timeStampPatterns:["D d M Y H:i:s","d.m.y g:i A","d.m.y g:i a","d.m.y H:i:s","d/m/y g:i A","d/m/y g:i a",
"d/m/y H:i:s","d-m-y g:i A","d-m-y g:i a","d-m-y H:i:s","Y-m-d-H.i.s.uu"],monthNames:["janeiro","fevereiro","mar\u00e7o","abril","maio","junho","julho","agosto","setembro","outubro","novembro","dezembro"],shortMonthNames:["Jan","Fev","Mar","Abr","Mai","Jun","Jul","Ago","Set","Out","Nov","Dez"],dayNames:["domingo","segunda","ter\u00e7a","quarta","quinta","sexta","s\u00e1bado"],shortDayNames:["Dom","Seg","Ter","Qua","Qui","Sex","S\u00e1b"],weekStart:0});pui.r.add({name:"nl_NL",text:"Dutch (Netherlands)",datePatterns:["Y-m-d","d.m.y","d.m.Y","d/m/y","d/m/Y","d-m-y","d-m-Y","Y/m","Y/m/d","y/m/d","j F y","j F Y","l j F y","l j F Y","D d M y","D d M Y","j-M-y","j-M-Y","j M y","j M Y","yz","y/z","y-z","y.z","Yz","Y/z","Y-z","Y.z"],timePatterns:["g:i","g:i:s","g:i a","g:i A","H:i","H.i.s","H:i:s","H:i a","H:i A","g:i:s a","g:i:s A","H:i:s a","H:i:s A"],timeStampPatterns:["D d M Y H:i:s","d.m.y g:i A","d.m.y g:i a","d.m.y H:i:s","d/m/y g:i A","d/m/y g:i a",
"d/m/y H:i:s","d-m-y g:i A","d-m-y g:i a","d-m-y H:i:s","Y-m-d-H.i.s.uu"],monthNames:["januari","februari","maart","april","mei","juni","juli","augustus","september","oktober","november","december"],shortMonthNames:["jan","feb","mrt","apr","mei","jun","jul","aug","sep","okt","nov","dec"],dayNames:["zondag","maandag","dinsdag","woensdag","donderdag","vrijdag","zaterdag"],shortDayNames:["zo","ma","di","wo","do","vr","za"],weekStart:1});pui.r.add({name:"da_DK",text:"Danish (Denmark)",datePatterns:["Y-m-d","d.m.y","d.m.Y","d/m/y","d/m/Y","d-m-y","d-m-Y","Y/m","Y/m/d","y/m/d","j F y","j F Y","l j F y","l j F Y","D d M y","D d M Y","j-M-y","j-M-Y","j M y","j M Y","yz","y/z","y-z","y.z","Yz","Y/z","Y-z","Y.z"],timePatterns:["g:i","g:i:s","g:i a","g:i A","H:i","H.i.s","H:i:s","H:i a","H:i A","g:i:s a","g:i:s A","H:i:s a","H:i:s A"],timeStampPatterns:["D d M Y H:i:s","d.m.y g:i A","d.m.y g:i a","d.m.y H:i:s","d/m/y g:i A","d/m/y g:i a",
"d/m/y H:i:s","d-m-y g:i A","d-m-y g:i a","d-m-y H:i:s","Y-m-d-H.i.s.uu"],monthNames:["januar","februar","marts","april","maj","juni","juli","august","september","oktober","november","december"],shortMonthNames:["jan","feb","mar","apr","maj","jun","jul","aug","sep","okt","nov","dec"],dayNames:["s\u00f8ndag","mandag","tirsdag","onsdag","torsdag","fredag","l\u00f8rdag"],shortDayNames:["s\u00f8n","man","tir","ons","tor","fre","l\u00f8r"],weekStart:1});pui.r.add({name:"es_MX",text:"Spanish (Mexico)",datePatterns:["Y-m-d","d.m.y","d.m.Y","d/m/y","d/m/Y","d-m-y","d-m-Y","Y/m","Y/m/d","y/m/d","j F y","j F Y","l j F y","l j F Y","D d M y","D d M Y","j-M-y","j-M-Y","j M y","j M Y","yz","y/z","y-z","Yz","Y/z","Y-z"],timePatterns:["g:i","g:i:s","g:i a","g:i A","H:i","H.i.s","H:i:s","H:i a","H:i A","g:i:s a","g:i:s A","H:i:s a","H:i:s A"],timeStampPatterns:["D d M Y H:i:s","d.m.y g:i A","d.m.y g:i a","d.m.y H:i:s","d/m/y g:i A","d/m/y g:i a","d/m/y H:i:s",
"d-m-y g:i A","d-m-y g:i a","d-m-y H:i:s","Y-m-d-H.i.s.uu"],monthNames:["enero","febrero","marzo","abril","mayo","junio","julio","agosto","septiembre","octubre","noviembre","diciembre"],shortMonthNames:["ene","feb","mar","abr","may","jun","jul","ago","sep","oct","nov","dic"],dayNames:["domingo","lunes","martes","mi\u00e9rcoles","jueves","viernes","s\u00e1bado"],shortDayNames:["dom","lun","mar","mi\u00e9","jue","vie","s\u00e1b"],weekStart:1});pui.r.add({name:"ga_IE",text:"Irish (Ireland)",datePatterns:["Y-m-d","d.m.y","d.m.Y","d/m/y","d/m/Y","d-m-y","d-m-Y","Y/m","Y/m/d","y/m/d","j F y","j F Y","l j F y","l j F Y","D d M y","D d M Y","j-M-y","j-M-Y","j M y","j M Y","yz","y/z","y-z","y.z","Yz","Y/z","Y-z","Y.z"],timePatterns:["g:i","g:i:s","g:i a","g:i A","H:i","H.i.s","H:i:s","H:i a","H:i A","g:i:s a","g:i:s A","H:i:s a","H:i:s A"],timeStampPatterns:["D d M Y H:i:s","d.m.y g:i A","d.m.y g:i a","d.m.y H:i:s","d/m/y g:i A","d/m/y g:i a",
"d/m/y H:i:s","d-m-y g:i A","d-m-y g:i a","d-m-y H:i:s","Y-m-d-H.i.s.uu"],monthNames:["Ean\u00e1ir","Feabhra","M\u00e1rta","Aibre\u00e1n","M\u00ed na Bealtaine","Meith","I\u00fail","L\u00fanasa","Me\u00e1n F\u00f3mhair","Deireadh F\u00f3mhair","M\u00ed na Samhna","M\u00ed na Nollag"],shortMonthNames:["Ean","Feabh","M\u00e1rta","Aib","Beal","Meith","I\u00fail","L\u00fan","MF\u00f3mh","DF\u00f3mh","Samh","Noll"],dayNames:["D\u00e9 Domhnaigh","D\u00e9 Luain","D\u00e9 M\u00e1irt","D\u00e9 C\u00e9adaoin",
"D\u00e9ardaoin","D\u00e9 hAoine","D\u00e9 Sathairn"],shortDayNames:["Domh","Luan","M\u00e1irt","C\u00e9ad","D\u00e9ar","Aoine","Sath"],weekStart:1});pui.r.add({name:"it_IT",text:"Italian (Italy)",datePatterns:["Y-m-d","d.m.y","d.m.Y","d/m/y","d/m/Y","d-m-y","d-m-Y","Y/m","Y/m/d","y/m/d","j F y","j F Y","l j F y","l j F Y","D d M y","D d M Y","j-M-y","j-M-Y","j M y","j M Y","yz","y/z","y-z","y.z","Yz","Y/z","Y-z","Y.z"],timePatterns:["g:i","g:i:s","g:i a","g:i A","H:i","H.i.s","H:i:s","H:i a","H:i A","g:i:s a","g:i:s A","H:i:s a","H:i:s A"],timeStampPatterns:["D d M Y H:i:s","d.m.y g:i A","d.m.y g:i a","d.m.y H:i:s","d/m/y g:i A","d/m/y g:i a",
"d/m/y H:i:s","d-m-y g:i A","d-m-y g:i a","d-m-y H:i:s","Y-m-d-H.i.s.uu"],monthNames:["gennaio","febbraio","marzo","aprile","maggio","giugno","luglio","agosto","settembre","ottobre","novembre","dicembre"],shortMonthNames:["gen","feb","mar","apr","mag","giu","lug","ago","set","ott","nov","dic"],dayNames:["domenica","luned\u00ec","marted\u00ec","mercoled\u00ec","gioved\u00ec","venerd\u00ec","sabato"],shortDayNames:["dom","lun","mar","mer","gio","ven","sab"],weekStart:1});pui.r.add({name:"he_IL",text:"Hebrew (Israel)",datePatterns:["Y-m-d","d/m/y","d/m/Y","n/j/y","n/j/Y","d-m-y","d-m-Y","n-j-y","n-j-Y","Y/m","m/Y","Y/m/d","y/m/d","l, F j, Y","l, F jS, Y","D, M d, y","D, M d, Y","D M d y","D M d Y","F j, y","F j, Y","M j, y","M j, Y","j-M-y","j-M-Y","yz","y/z","y-z","Yz","Y/z","Y-z"],timePatterns:["g:i","g:i:s","g:i a","g:i A","H:i","H.i.s","H:i:s","H:i a","H:i A","g:i:s a","g:i:s A","H:i:s a","H:i:s A"],timeStampPatterns:["d/m/y g:i A","d/m/y g:i a","d/m/y H:i:s",
"d-m-y g:i A","d-m-y g:i a","d-m-y H:i:s","D, M d, Y H:i:s","g:i A o\\n n/j/y","Y-m-d-H.i.s.uu"],monthNames:["\u05d9\u05e0\u05d5\u05d0\u05e8","\u05e4\u05d1\u05e8\u05d5\u05d0\u05e8","\u05de\u05d0\u05e8\u05e1","\u05d0\u05e4\u05e8\u05d9\u05dc","\u05de\u05d0\u05d9","\u05d9\u05d5\u05e0\u05d9","\u05d9\u05d5\u05dc\u05d9","\u05d0\u05d5\u05d2\u05d5\u05e1\u05d8","\u05e1\u05e4\u05d8\u05de\u05d1\u05e8","\u05d0\u05d5\u05e7\u05d8\u05d5\u05d1\u05e8","\u05e0\u05d5\u05d1\u05de\u05d1\u05e8","\u05d3\u05e6\u05de\u05d1\u05e8"],
shortMonthNames:["\u05d9\u05e0.","\u05e4\u05d1\u05e8","\u05de\u05d0\u05e8\u05e1","\u05d0\u05e4\u05e8","\u05de\u05d0\u05d9","\u05d9\u05d5\u05e0\u05d9","\u05d9\u05d5\u05dc\u05d9","\u05d0\u05d5\u05d2","\u05e1\u05e4\u05d8","\u05d0\u05d5\u05e7","\u05e0\u05d5\u05d1","\u05d3\u05e6\u05de"],dayNames:["\u05e8\u05d0\u05e9\u05d5\u05df","\u05e9\u05e0\u05d9","\u05e9\u05dc\u05d9\u05e9\u05d9","\u05e8\u05d1\u05d9\u05e2\u05d9","\u05d7\u05de\u05d9\u05e9\u05d9","\u05e9\u05d9\u05e9\u05d9","\u05e9\u05d1\u05ea"],shortDayNames:["\u05d0",
"\u05d1","\u05d2","\u05d3","\u05d4","\u05d5","\u05e9"],weekStart:0});var D={};D.ta=null;D.i=FLAT_LOOK?"/profoundui/proddata/images/FlatIcons/":"/profoundui/proddata/images/icons/";D.a={};D.G=null;D.B=null;D.g=null;D.k=false;D.ra=null;D.f=null;D.pa=null;D.m=[];D.u=null;D.ha=null;D.Da=false;D.z=null;D.Ba=null;D.j=null;D.D=null;D.F=null;D.fb=null;D.qa=null;D.L=null;D.l=null;D.o=[];D.forms=[];D.ga=null;D.q=null;D.xa=null;D.v=null;D.ba=null;D.z=null;D.d=170;
D.vc={run:function(){var a=D.k==true?D.B:D.G;if(a==null)D.D.disable();else{D.$a(a)?D.D.enable():D.D.disable();D.z!=null&&D.z!=editor.getValue()?D.F.enable():D.F.disable()}},interval:100};D.a.defaultSkin='Controls the skin Genie will use when none is otherwise specified. This defaults to "Hybrid".';D.a.enableDesigner="Determines whether the Design Toolbar will be enabled. This defaults to true.";D.a.adjustColumns="When set to true, Genie will use the field's attribute position when assigning its column number. This behavior is compatible with Profound UI versions prior to 3 and with the older stand-alone Genie versions. When set to false, Genie will assign the field's actual start position (as given in DDS) as the column number. The default value is false.";
D.a.connectionType="Determines the type of connection used to exchange 5250 streams with the server. WebFacing Server connections (Genie Accelerator) do not use interactive processing. However, the following features are not supported through the WebFacing Server: custom workstation ids, automated sign on, and assignment of client IP address to workstation device. The default is to use a Virtual Terminal connection.";D.a.host='The IP address or host name to use when connecting to the WebFacing server. This defaults to the "localhost".';
D.a.port="The port on which to connect to the WebFacing Server. This defaults to port 4004.";D.a.workStnFieldId='Upon successful sign on, Genie will store information about the 5250 session job for later use. Genie retrieves this information by detecting the session\'s workstation id on the sign on screen. This setting specifies the Genie field id on the sign on screen that will be used to retrieve the workstation id. This defaults to "D_4_70".';D.a.pcCommandMode='Which PC-side implementation to use for running PC commands for STRPCCMD and the "runPCCommand()" API. The PC Integration Applet requires that Java is installed on the PC and that the web browser supports the Java plug-in. The PC Command Listener and the Launcher require separate installations on the PC. By default, the applet is used.';
D.a.listenerPort="Sets the port number for connections to the PC Command Listener. If not set, Genie will connect on port 80.";D.a.closeMessage="Additional message text to display in the confirmation prompt when the user tries to end the session abnormally -- such as closing down the browser. Note that a customized closing message will only display properly when using Internet Explorer. The window text in other browsers, such as Chrome and Firefox, is not able to be customized due to changes made to the browser. ";
D.a.detectSubfile="Determines whether Genie should look for subfiles on each screen.  The default value is true.";D.a.detectSubfilePatterns="This flag tells Genie to look for a subfile by detecting a pattern of rows that are formatted in the same way.  When a subfile is detected using this method, a grid widget is created over it.  If the flag is not set to true, Genie looks for Option Headings, instead, in order to detect the subfile.";D.a.detectSubfileEndPlus="When \"detect subfile patterns\" is selected, this flag will allow Genie to recognize a 1A output field usually containing a '+' on the end of the last row, and remove it so that it will not interrupt the pattern detection. The default value for this property is true.";
D.a.findOptionColumn='When "Detect Subfile Patterns" is selected, this flag is used to prevent false positives by only creating grids on subfiles where an Option Column exists.';D.a.pagingBar='When "Detect Subfile Patterns" is selected and this flag is set to "true", the subfile grid widget will include a paging bar. When set to "false" a paging scrollbar will be used. The default value is "false".';D.a.optionHeadings='Specifies a comma separated list of headings to look for to identify a subfile option column.  This method of detecting subfiles is used only when the "Detect Subfile Patterns" option is not selected.  The default value for this property is OPT,SEL.';
D.a.outlineSubfile="If a subfile is found using the Option Headings method, this flag determines whether an outline is drawn around the subfile area.";D.a.subfileOutlineColor='Sets the outline color when the "Outline Subfiles" option is used. This can be give either as a CSS color name, such as "red", or as a hex code, such as "#FF0000". The default color is "yellow".';D.a.separateSubfileLines="If a subfile is found using the Option Headings method, this flag determines whether a separator line is drawn between each subfile line.";
D.a.hideSubfileOpt="If a subfile is found using the Option Headings method, this flag tells Genie to find and hide an option input box on each subfile line.  Instead of using the input box, the user will be able to right-click the subfile to select the appropriate option.";D.a.stripedSubfile="Determines if the subfile rows are striped with alternate colors.";D.a.oddRowColor="The color of the odd rows in a striped subfile.";D.a.evenRowColor="The color of the even rows in a striped subfile.";
D.a.hiColor="Defines the color of the row when it is hovered over with the mouse.";D.a.hiFontColor="Defines the color of the text within the row when the row is hovered over with the mouse.";D.a.multX="Controls the horizontal spacing between fields. The field's column number is multiplied by this number to derive the pixel offset from the left edge of the 5250 area.";D.a.multY="Controls the vertical spacing between fields. The field's row number is multiplied by this number to derive the pixel offset from the top edge of the 5250 area.";
D.a.inputPadding="Extra width (in pixels) to assign to input fields. This can be used to adjust for input field border styling, variations in font rendering, etc. Defaults to 4 if not specified.";D.a.alertErrors="When set to true, Genie presents green-screen errors in an alert box.  When set to false, errors are displayed at the bottom of the screen only.";D.a.detectDateFields="When set to true, Genie looks for date fields on this screen and automatically attaches a calendar control to any field that it finds.";
D.a.defaultDateFormat="Defines the default date format to be used in calendar controls.";D.a.locale="Defines a locale that can be used to control various settings. Currently, only the text display for month and day names on the calendar widget is affected by this setting.";D.a.detectMenus="When set to true, Genie will attempt to detect menu panels and transform the menu options into hyperlinks. The default value is true.";D.a.enlargeHeadings="When set to true, Genie looks for the screen heading and automatically increases its font size and adds a shadow.";
D.a.functionKeyButtons='Determines whether function key labels, such as "F3=Exit", are transformed into buttons.';D.a.hideFKeyNames='Tells Genie to look for function key labels and remove the function key name.  For example, "F3=Exit" becomes "Exit".  The user will be able to click on the field to send the appropriate function key to the server.';D.a.overtypeMode='Determines if the default keyboard cursor mode is overtype or insert.  In overtype mode, the characters you type replace existing characters one by one.  In insert mode, the characters you type move existing text to the right.  The default value is true. Note that this functionality will only work in Internet Explorer. For similar functionality in other browsers, we suggest using the "Highlight On Focus" option.';
D.a.highlightOnFocus="Highlights text in input fields when focus is received.  The default value is false.";D.a.preventAutoTab="If set to false, Genie overrides the browser's default behavior of the Tab key with its own automatic tabbing.  If set to true, the browser's default behavior is used for tabbing.  The default value is false.";D.a.setFieldBackground="If set to true, Genie will set the background color of all fields to the match the main screen background color, preventing any underlying items from showing through. If set to false, all fields will be given a transparent background, allowing any underlying items to show through. The default value is false.";
D.a.useFixedFont="If set to true, Genie will set the font for all screens to Monospace. If set to false, Genie will use the font specified in the style sheet for this skin. The default value is false.";D.a.detectWindowBorder="If set to true, Genie will detect window border fields (such as a string of dots) and apply the browser's default monospace font to them. The default value is true.";D.a.autoSizeFont="When set to true, Genie will automatically adjust the font size and spacing when the size of the browser window changes.";
D.a.browserAutoComplete="When set to true, Genie will enable the browser to store previous form entries and suggest matches for the user as they type.  The default value is false.  The Auto Complete feature (also known as the Auto Fill feature in some browsers) must be enabled within browser settings.  If this feature is enabled, Overtype Mode should be set to false.";D.a.adjustWindowBorders="When set to true, Genie will adjust the position and height of reverse image/space window borders in order to prevent gaps in the border. The default value is true.";
Ext.onReady(function(){D.init()});
D.init=function(){FLAT_LOOK&&D.zb();D.ta=!Ext.isIE||!Ext.Hd&&!Ext.isIE6&&!Ext.isIE7&&!Ext.isIE8;Ext.QuickTips.init();Ext.BLANK_IMAGE_URL="/"+EXT_PATH+"/resources/images/default/s.gif";D.ra=new Ext.data.ArrayStore({fields:["format"]});D.ra.loadData([[""],["MM/DD/YY"],["MM/DD/YYYY"],["DD/MM/YY"],["DD/MM/YYYY"],["DD.MM.YY"],["DD.MM.YYYY"],["MMDDYY"],["MMDDYYYY"],["DDMMYY"],["YYMMDD"],["YY/MM/DD"],["YYYYMMDD"],["YYYY-MM-DD"],["YYY/MM/DD"]]);D.f=new Ext.data.ArrayStore({fields:["stateText","state"]});
D.f.loadData([["",null],["true",true],["false",false]]);D.pa=new Ext.data.ArrayStore({fields:["text","value"]});D.pa.loadData([["",null],["Virtual Terminal","V"],["WebFacing Server","W"]]);D.ha=new Ext.data.ArrayStore({fields:["screenName","idText","isWindow"]});for(var a=[["",null]],d=pui.r.Yb(),c=0;c<d.length;c++)a.push([d[c].text,d[c].name]);D.gb=new Ext.data.ArrayStore({fields:["text","name"]});D.gb.loadData(a);D.Ba=new Ext.data.ArrayStore({fields:["text","value"]});D.Ba.loadData([["",null],["Integration Applet",
"applet"],["Command Listener","listener"],["Command Listener mode 2","listener_m2"],["Command Launcher","launcher"]]);Ext.Ajax.request({url:DOCUMENT_URI,method:"post",params:{task:"getSkins"},callback:function(e,f,g){if(f){e=Ext.util.JSON.decode(g.responseText);if(e.error)Ext.MessageBox.alert("Error","Error retrieving skins list: "+e.error);else D.m=typeof e.sort!="undefined"?e.sort():e}else Ext.MessageBox.alert("Error","Error retrieving skins list: "+g.status+" - "+g.statusText+".");D.u=new Ext.data.ArrayStore({fields:["skin"]});
e=[];e.push(Array(""));for(f=0;f<D.m.length;f++)e.push(Array(D.m[f]));D.u.loadData(e);D.Lb();Ext.TaskMgr.start(D.vc)}})};
D.Lb=function(){navigator.userAgent.indexOf("Trident/4.0")!=-1&&Ext.getBody().addClass("GenieAdmin-ie8");var a=new Ext.Viewport({layout:"border",id:"GenieAdmin-viewPort",items:[D.Kb(),D.Gb(),D.Fb(),D.Eb()]});D.j=new Ext.LoadMask(a.getEl());D.l=Ext.getCmp("GenieAdmin-mainPanel");D.D=Ext.getCmp("GenieAdmin-saveButton");D.F=Ext.getCmp("GenieAdmin-saveFileButton");D.qa=Ext.getCmp("GenieAdmin-copyButton");D.L=Ext.getCmp("GenieAdmin-deleteSkinButton");D.fb=Ext.getCmp("GenieAdmin-launchButton");D.o.push(Ext.getCmp("GenieAdmin-generalTab"));
D.o.push(Ext.getCmp("GenieAdmin-subfileTab"));D.o.push(Ext.getCmp("GenieAdmin-renderingTab"));D.forms.push(Ext.getCmp("GenieAdmin-generalForm").getForm());D.forms.push(Ext.getCmp("GenieAdmin-subfileForm").getForm());D.forms.push(Ext.getCmp("GenieAdmin-renderingForm").getForm());D.ga=Ext.getCmp("GenieAdmin-screensPanel");D.q=Ext.getCmp("GenieAdmin-editFilePanel");D.v=Ext.getCmp("GenieAdmin-navPanel");D.xa=Ext.getCmp("GenieAdmin-helpPanel");D.ba=new E;for(a=0;a<D.o.length;a++)D.l.activate(D.o[a]);D.l.hideTabStripItem(D.ga);
D.l.hideTabStripItem(D.q);D.F.hide();D.pc()==true?D.Gc(function(){D.v.items.itemAt(0).expand()}):D.v.items.itemAt(0).expand()};D.pc=function(){for(var a=document.cookie.split(";"),d,c,e=0;e<a.length;e++){c=a[e].split("=");if(c.length==2){d=c[0].replace(/^\s*|\s*$/g,"");c=c[1].replace(/^\s*|\s*$/g,"");if(d=="GenieAdminNoShow"&&c=="true")return false}}return true};
D.Gc=function(a){var d=new Ext.Window({title:"Genie",width:FLAT_LOOK?375:300,height:FLAT_LOOK?250:200,layout:"fit",modal:true,resizable:false,items:[new Ext.Panel({layout:"fit",html:'Welcome to the Genie Administrator.<br /><br />The Administrator is an interface used for configuring Genie. Settings can be made either globally or per skin. Use the launch button on the toolbar when finished to start Genie.<br /><br /><br /><input type="checkbox" value="Y" />&nbsp;Don\'t show this message again.',bodyStyle:"padding: 5px;",
frame:true,bbar:new Ext.Toolbar({border:false,items:[new Ext.form.Checkbox({id:"GenieAdmin-noShowBox",name:"noshow",boxLabel:"Don't show this message again.",Xc:true})]})})],buttons:[{text:"OK",handler:function(){if(Ext.getCmp("GenieAdmin-noShowBox").getValue()==true)document.cookie="GenieAdminNoShow=true; expires=Fri, 31 Dec 2099 23:59:59 GMT; path=/";d.close()}}],listeners:{close:a}});d.show()};
D.Kb=function(){Ext.get("banner").dom.style.display="block";return new Ext.Panel({region:"north",split:false,height:130,collapsible:false,margins:"0 0 0 0",items:[new Ext.BoxComponent({el:"banner",height:100}),new Ext.Toolbar({height:31,autoWidth:true,items:[{id:"GenieAdmin-launchButton",text:"&nbsp;Launch&nbsp;",cls:"x-btn-text-icon",icon:D.i+(FLAT_LOOK?"launch-16x16.png":"application_go.png"),handler:function(){window.open(D.Wb(),"_blank")}},{id:"GenieAdmin-saveButton",text:"&nbsp;Save Configuration&nbsp;",
cls:"x-btn-text-icon",icon:D.i+(FLAT_LOOK?"save.png":"disk.png"),handler:D.kb},{id:"GenieAdmin-saveFileButton",text:"&nbsp;Save File&nbsp;",cls:"x-btn-text-icon",icon:D.i+(FLAT_LOOK?"save.png":"disk.png"),handler:D.Ca},{id:"GenieAdmin-copyButton",text:"&nbsp;Copy Skin&nbsp;",cls:"x-btn-text-icon",icon:D.i+"copy.png",disabled:true,handler:D.Ec},{id:"GenieAdmin-deleteSkinButton",text:"&nbsp;Delete Skin&nbsp;",cls:"x-btn-text-icon",icon:D.i+(FLAT_LOOK?"remove.png":"delete.png"),disabled:true,handler:D.Fc},
{text:"&nbsp;About Genie&nbsp;",cls:"x-btn-text-icon",icon:D.i+(FLAT_LOOK?"about-16x16.png":"information.png"),handler:D.Cc},new Ext.Toolbar.Fill,{text:"&nbsp;Exit&nbsp;",cls:"x-btn-text-icon",icon:D.i+(FLAT_LOOK?"exit-16x16.png":"door_out.png"),handler:function(){D.V(function(){document.body.innerHTML='<div style="width: 100%; text-align:center; font-size:200%;"><br/>Please close your browser to exit the Genie Administrator.</div>';window.close()})}}]})]})};
D.Gb=function(){var a=[],d;d=new Ext.tree.TreePanel({rootVisible:false,lines:false,root:new Ext.tree.TreeNode({text:"Global"})});d.root.appendChild(new Ext.tree.TreeNode({text:"Configuration",global:true,listeners:{click:D.oa},icon:D.i+(FLAT_LOOK?"wrench-16x18.png":"wrench.png")}));a.push(new Ext.Panel({title:"Global",layout:"fit",hideCollapseTool:false,items:d,global:true,collapsed:true,hideBorders:true,listeners:{beforeexpand:D.K},height:100}));for(var c=0;c<D.m.length;c++){d=new Ext.tree.TreePanel({rootVisible:false,
lines:false,root:new Ext.tree.TreeNode({text:"Global"})});d.root.appendChild(new Ext.tree.TreeNode({text:"Configuration",p:D.m[c],listeners:{click:D.oa},icon:D.i+(FLAT_LOOK?"wrench-16x18.png":"wrench.png")}));d.root.appendChild(new Ext.tree.TreeNode({text:"Screens",p:D.m[c],listeners:{click:D.lb},icon:D.i+(FLAT_LOOK?"screens-16x18.png":"application_cascade.png")}));if(D.ta){d.root.appendChild(new Ext.tree.TreeNode({text:"Edit start.html",p:D.m[c],listeners:{click:function(){D.M("start.html")}},icon:D.i+
(FLAT_LOOK?"pencil-16x18.png":"code.png")}));d.root.appendChild(new Ext.tree.TreeNode({text:"Edit custom.js",p:D.m[c],listeners:{click:function(){D.M("custom.js")}},icon:D.i+(FLAT_LOOK?"pencil-16x18.png":"code.png")}));d.root.appendChild(new Ext.tree.TreeNode({text:"Edit "+D.m[c]+".css",p:D.m[c],listeners:{click:function(){D.M(D.g+".css")}},icon:D.i+(FLAT_LOOK?"pencil-16x18.png":"code.png")}))}a.push(new Ext.Panel({title:D.m[c]+" Skin",layout:"fit",hideCollapseTool:false,items:d,p:D.m[c],collapsed:true,
hideBorders:true,bodyStyle:"background-color: #FFFFFF;",listeners:{beforeexpand:D.K},height:140}))}return new Ext.Panel({id:"GenieAdmin-navPanel",layout:"accordion",region:"west",title:"Skins",collapsible:true,split:true,margins:"0 0 0 5",autoScroll:true,hideBorders:true,layoutConfig:{fill:false},width:200,nc:175,lc:400,items:a})};
D.Fb=function(){return new Ext.TabPanel({region:"center",id:"GenieAdmin-mainPanel",tabPosition:"top",enableTabScroll:true,activeTab:0,autoScroll:true,items:[D.Db(),D.Jb(),D.Hb(),D.Ib(),D.Cb()]})};D.Eb=function(){return new Ext.Panel({region:"south",id:"GenieAdmin-helpPanel",title:"Help",split:true,height:150,nc:75,lc:200,collapsible:true,margins:"0 0 0 0",animCollapse:false,bodyStyle:"padding: 5px; font-family: arial, verdana, sans-serif; font-size: 12px;"})};
D.Db=function(){return new Ext.Panel({id:"GenieAdmin-generalTab",title:"General Settings",closable:false,autoScroll:true,items:[new Ext.form.FormPanel({id:"GenieAdmin-generalForm",labelWidth:150,frame:false,border:false,bodyStyle:"padding:10px;",items:[new Ext.form.ComboBox({name:"defaultSkin",fieldLabel:"Default Skin",width:D.d,editable:false,forceSelection:true,hideMode:"display",mode:"local",triggerAction:"all",store:D.u,displayField:"skin",valueField:"skin",listeners:{focus:D.c,blur:D.b}}),new Ext.form.ComboBox({name:"enableDesigner",
fieldLabel:"Enable Designer",width:D.d,editable:false,forceSelection:true,mode:"local",triggerAction:"all",store:D.f,displayField:"stateText",valueField:"state",disabled:LICENSE_DEV?false:true,listeners:{focus:D.c,blur:D.b}}),new Ext.form.ComboBox({name:"adjustColumns",fieldLabel:"Adjust Columns",width:D.d,editable:false,forceSelection:true,mode:"local",triggerAction:"all",store:D.f,displayField:"stateText",valueField:"state",disabled:LICENSE_DEV?false:true,listeners:{focus:D.c,blur:D.b}}),new Ext.form.ComboBox({name:"connectionType",
fieldLabel:"Connection type",width:D.d,editable:false,forceSelection:true,mode:"local",triggerAction:"all",store:D.pa,displayField:"text",valueField:"value",listeners:{focus:D.c,blur:D.b,select:function(a,d){var c=Ext.getCmp("GenieAdmin-generalForm").getForm().findField("host"),e=Ext.getCmp("GenieAdmin-generalForm").getForm().findField("port");if(d==null||d.get("value")!="W"){c.setValue("");c.disable();c.getEl().up("div.x-form-item").setDisplayed(false);e.setValue("");e.disable();e.getEl().up("div.x-form-item").setDisplayed(false)}else{c.enable();
c.getEl().up("div.x-form-item").setDisplayed(true);e.enable();e.getEl().up("div.x-form-item").setDisplayed(true)}}}}),new Ext.form.TextField({name:"host",fieldLabel:"WebFacing Server host",width:D.d,listeners:{focus:D.c,blur:D.b}}),new Ext.form.NumberField({name:"port",fieldLabel:"WebFacing Server port",width:D.d,allowDecimals:false,allowNegative:false,autoCreate:{tag:"input",maxlength:5},listeners:{focus:D.c,blur:D.b}}),new Ext.form.TextField({name:"workStnFieldId",fieldLabel:"Workstation Id Field",
width:D.d,listeners:{focus:D.c,blur:D.b}}),new Ext.form.ComboBox({name:"pcCommandMode",fieldLabel:"PC Command Mode",width:D.d,editable:false,forceSelection:true,mode:"local",triggerAction:"all",store:D.Ba,displayField:"text",valueField:"value",listeners:{focus:D.c,blur:D.b,select:function(a,d){var c=Ext.getCmp("GenieAdmin-generalForm").getForm().findField("listenerPort");if(d==null||d.get("value")!="listener"&&d.get("value")!="listener_m2"){c.setValue("");c.disable();c.getEl().up("div.x-form-item").setDisplayed(false)}else{c.enable();
c.getEl().up("div.x-form-item").setDisplayed(true)}}}}),new Ext.form.NumberField({name:"listenerPort",fieldLabel:"PC Command Listener port",width:D.d,allowDecimals:false,allowNegative:false,autoCreate:{tag:"input",maxlength:5},listeners:{focus:D.c,blur:D.b}}),new Ext.form.TextArea({name:"closeMessage",fieldLabel:"Close Message",width:300,height:100,listeners:{focus:D.c,blur:D.b}})]})]})};
D.Jb=function(){return new Ext.Panel({id:"GenieAdmin-subfileTab",title:"Subfile Settings",closable:false,autoScroll:true,items:[new Ext.form.FormPanel({id:"GenieAdmin-subfileForm",frame:false,border:false,bodyStyle:"padding:10px;",labelWidth:140,items:[new Ext.form.ComboBox({name:"detectSubfile",fieldLabel:"Detect Subfiles",width:D.d,editable:false,forceSelection:true,mode:"local",triggerAction:"all",store:D.f,displayField:"stateText",valueField:"state",listeners:{focus:D.c,blur:D.b}}),new Ext.form.ComboBox({name:"detectSubfilePatterns",
fieldLabel:"Detect Subfile Patterns",width:D.d,editable:false,forceSelection:true,mode:"local",triggerAction:"all",store:D.f,displayField:"stateText",valueField:"state",listeners:{focus:D.c,blur:D.b}}),new Ext.form.ComboBox({name:"detectSubfileEndPlus",fieldLabel:"Detect Subfile End Plus",width:D.d,editable:false,forceSelection:true,mode:"local",triggerAction:"all",store:D.f,displayField:"stateText",valueField:"state",listeners:{focus:D.c,blur:D.b}}),new Ext.form.ComboBox({name:"findOptionColumn",
fieldLabel:"Find Option Column",width:D.d,editable:false,forceSelection:true,mode:"local",triggerAction:"all",store:D.f,displayField:"stateText",valueField:"state",listeners:{focus:D.c,blur:D.b}}),new Ext.form.ComboBox({name:"pagingBar",fieldLabel:"Grid Paging Bar",width:D.d,editable:false,forceSelection:true,mode:"local",triggerAction:"all",store:D.f,displayField:"stateText",valueField:"state",listeners:{focus:D.c,blur:D.b}}),new Ext.form.TextField({name:"optionHeadings",fieldLabel:"Option Headings",
width:D.d,listeners:{focus:D.c,blur:D.b}}),new Ext.form.ComboBox({name:"outlineSubfile",fieldLabel:"Outline Subfiles",width:D.d,editable:false,forceSelection:true,mode:"local",triggerAction:"all",store:D.f,displayField:"stateText",valueField:"state",listeners:{focus:D.c,blur:D.b}}),new Ext.form.TextField({name:"subfileOutlineColor",fieldLabel:"Subfile Outline Color",width:D.d,listeners:{focus:D.c,blur:D.b,render:D.O}}),new Ext.form.ComboBox({name:"separateSubfileLines",fieldLabel:"Separate Subfile Lines",
width:D.d,editable:false,forceSelection:true,mode:"local",triggerAction:"all",store:D.f,displayField:"stateText",valueField:"state",listeners:{focus:D.c,blur:D.b}}),new Ext.form.ComboBox({name:"hideSubfileOpt",fieldLabel:"Hide Subfile Options",width:D.d,editable:false,forceSelection:true,mode:"local",triggerAction:"all",store:D.f,displayField:"stateText",valueField:"state",listeners:{focus:D.c,blur:D.b}}),new Ext.form.ComboBox({name:"stripedSubfile",fieldLabel:"Stripe Subfile Lines",width:D.d,editable:false,
forceSelection:true,mode:"local",triggerAction:"all",store:D.f,displayField:"stateText",valueField:"state",listeners:{focus:D.c,blur:D.b}}),new Ext.form.TextField({name:"oddRowColor",fieldLabel:"Odd Row Color",width:D.d,listeners:{focus:D.c,blur:D.b,render:D.O}}),new Ext.form.TextField({name:"evenRowColor",fieldLabel:"Even Row Color",width:D.d,listeners:{focus:D.c,blur:D.b,render:D.O}}),new Ext.form.TextField({name:"hiColor",fieldLabel:"Row Highlight Color",width:D.d,listeners:{focus:D.c,blur:D.b,
render:D.O}}),new Ext.form.TextField({name:"hiFontColor",fieldLabel:"Row Highlight Font Color",width:D.d,listeners:{focus:D.c,blur:D.b,render:D.O}})]})]})};
D.Hb=function(){return new Ext.Panel({id:"GenieAdmin-renderingTab",title:"Rendering Settings",closable:false,autoScroll:true,items:[new Ext.form.FormPanel({id:"GenieAdmin-renderingForm",frame:false,border:false,bodyStyle:"padding:10px;",labelWidth:150,items:[new Ext.form.NumberField({name:"multX",fieldLabel:"X Multiplier",width:D.d,allowDecimals:true,allowNegative:false,autoCreate:{tag:"input",maxlength:5},listeners:{focus:D.c,blur:D.b}}),new Ext.form.NumberField({name:"multY",fieldLabel:"Y Multiplier",
width:D.d,allowDecimals:true,allowNegative:false,autoCreate:{tag:"input",maxlength:5},listeners:{focus:D.c,blur:D.b}}),new Ext.form.NumberField({name:"inputPadding",fieldLabel:"Input Padding",width:D.d,allowDecimals:true,allowNegative:false,autoCreate:{tag:"input",maxlength:5},listeners:{focus:D.c,blur:D.b}}),new Ext.form.ComboBox({name:"alertErrors",fieldLabel:"Alert Errors",width:D.d,editable:false,forceSelection:true,mode:"local",triggerAction:"all",store:D.f,displayField:"stateText",valueField:"state",
listeners:{focus:D.c,blur:D.b}}),new Ext.form.ComboBox({name:"detectDateFields",fieldLabel:"Detect Date Fields",width:D.d,editable:false,forceSelection:true,mode:"local",triggerAction:"all",store:D.f,displayField:"stateText",valueField:"state",listeners:{focus:D.c,blur:D.b}}),new Ext.form.ComboBox({name:"defaultDateFormat",fieldLabel:"Default Date Format",width:D.d,editable:false,forceSelection:true,mode:"local",triggerAction:"all",store:D.ra,displayField:"format",valueField:"format",listeners:{focus:D.c,
blur:D.b}}),new Ext.form.ComboBox({name:"locale",fieldLabel:"Locale",width:D.d,editable:false,forceSelection:true,mode:"local",triggerAction:"all",store:D.gb,displayField:"text",valueField:"name",listeners:{focus:D.c,blur:D.b}}),new Ext.form.ComboBox({name:"detectMenus",fieldLabel:"Detect Menus",width:D.d,editable:false,forceSelection:true,mode:"local",triggerAction:"all",store:D.f,displayField:"stateText",valueField:"state",listeners:{focus:D.c,blur:D.b}}),new Ext.form.ComboBox({name:"enlargeHeadings",
fieldLabel:"Enlarge Headings",width:D.d,editable:false,forceSelection:true,mode:"local",triggerAction:"all",store:D.f,displayField:"stateText",valueField:"state",listeners:{focus:D.c,blur:D.b}}),new Ext.form.ComboBox({name:"functionKeyButtons",fieldLabel:"Function Key Buttons",width:D.d,editable:false,forceSelection:true,mode:"local",triggerAction:"all",store:D.f,displayField:"stateText",valueField:"state",listeners:{focus:D.c,blur:D.b}}),new Ext.form.ComboBox({name:"hideFKeyNames",fieldLabel:"Hide Function Key Names",
width:D.d,editable:false,forceSelection:true,mode:"local",triggerAction:"all",store:D.f,displayField:"stateText",valueField:"state",listeners:{focus:D.c,blur:D.b}}),new Ext.form.ComboBox({name:"preventAutoTab",fieldLabel:"Prevent Auto Tab",width:D.d,editable:false,forceSelection:true,mode:"local",triggerAction:"all",store:D.f,displayField:"stateText",valueField:"state",listeners:{focus:D.c,blur:D.b}}),new Ext.form.ComboBox({name:"setFieldBackground",fieldLabel:"Set Field Background Color",width:D.d,
editable:false,forceSelection:true,mode:"local",triggerAction:"all",store:D.f,displayField:"stateText",valueField:"state",listeners:{focus:D.c,blur:D.b}}),new Ext.form.ComboBox({name:"useFixedFont",fieldLabel:"Use Fixed Font",width:D.d,editable:false,forceSelection:true,mode:"local",triggerAction:"all",store:D.f,displayField:"stateText",valueField:"state",listeners:{focus:D.c,blur:D.b}}),new Ext.form.ComboBox({name:"detectWindowBorder",fieldLabel:"Detect Window Border",width:D.d,editable:false,forceSelection:true,
mode:"local",triggerAction:"all",store:D.f,displayField:"stateText",valueField:"state",listeners:{focus:D.c,blur:D.b}}),new Ext.form.ComboBox({name:"overtypeMode",fieldLabel:"Overtype Mode",width:D.d,editable:false,forceSelection:true,mode:"local",triggerAction:"all",store:D.f,displayField:"stateText",valueField:"state",listeners:{focus:D.c,blur:D.b}}),new Ext.form.ComboBox({name:"highlightOnFocus",fieldLabel:"Highlight On Focus",width:D.d,editable:false,forceSelection:true,mode:"local",triggerAction:"all",
store:D.f,displayField:"stateText",valueField:"state",listeners:{focus:D.c,blur:D.b}}),new Ext.form.ComboBox({name:"autoSizeFont",fieldLabel:"Auto-size Font",width:D.d,editable:false,forceSelection:true,mode:"local",triggerAction:"all",store:D.f,displayField:"stateText",valueField:"state",listeners:{focus:D.c,blur:D.b}}),new Ext.form.ComboBox({name:"browserAutoComplete",fieldLabel:"Browser Auto Complete",width:D.d,editable:false,forceSelection:true,mode:"local",triggerAction:"all",store:D.f,displayField:"stateText",
valueField:"state",listeners:{focus:D.c,blur:D.b}}),new Ext.form.ComboBox({name:"adjustWindowBorders",fieldLabel:"Adjust Window Borders",width:D.d,editable:false,forceSelection:true,mode:"local",triggerAction:"all",store:D.f,displayField:"stateText",valueField:"state",listeners:{focus:D.c,blur:D.b}})]})]})};D.c=function(a){function d(){D.xa.body.update(c)}var c=D.a[a.getName()];c!=null&&d.defer(10)};D.b=function(){D.xa.body.update("")};
D.oa=function(){for(var a=D.l.getActiveTab(),d=0;d<D.o.length;d++)if(D.o[d]==a)return;D.V(function(){D.mb();D.F.hide();D.D.show()})};D.lb=function(){D.l.getActiveTab()!=D.ga&&D.V(function(){D.nb();D.F.hide();D.D.hide()})};D.M=function(a){D.l.getActiveTab()==D.q&&D.q.fileName==a||D.V(function(){D.F.show();D.D.hide();D.Rb(a)})};D.Cb=function(){return new Ext.Panel({id:"GenieAdmin-editFilePanel",title:"This is where my file path will be.",closable:false,autoScroll:true,html:"<div id='editor' style='position:relative; left:0%; top:0%; width:99%; height:99%; border:1px solid #dddddd'> </div>"})};
D.Rb=function(a){D.L.disable();for(var d=0;d<D.o.length;d++)D.l.hideTabStripItem(D.o[d]);D.l.unhideTabStripItem(D.q);D.q.fileName=a;D.l.activate(D.q);d="text";switch(a.split(".")[1]){case "html":d="html";break;case "js":d="javascript";break;case "css":d="css";break}editor=ace.edit("editor");editor.setTheme("ace/theme/eclipse");editor.setShowPrintMargin(false);editor.session.setTabSize(2);editor.getSession().setMode("ace/mode/"+d);editor.session.setUseWrapMode(false);editor.renderer.setShowGutter(true);
editor.commands.addCommand({name:"save",exec:function(){D.Ca()},bindKey:{mac:"cmd-s",win:"ctrl-s"}});D.j.show();Ext.Ajax.request({url:DOCUMENT_URI,method:"post",params:{task:"getSkinFile",skin:D.g,file:a},callback:function(c,e,f){if(e){var g=Ext.util.JSON.decode(f.responseText);D.z=g.file==null?"":D.Mb(g.file)}else Ext.MessageBox.alert("Error","Error retrieving file: "+f.status+" - "+f.statusText+".");D.q.setTitle(g.path);editor.setValue(D.z);c=editor.getSession().getUndoManager();c.reset();editor.getSession().setUndoManager(c);
editor.selection.moveCursorFileStart();editor.focus();D.j.hide()}})};
D.mb=function(){D.k||D.L.enable();D.D.show();D.F.hide();D.l.hideTabStripItem(D.q);for(var a=0;a<D.o.length;a++){D.l.unhideTabStripItem(D.o[a]);a==0&&D.l.activate(D.o[a])}if(D.k){D.forms[0].findField("defaultSkin").show();D.forms[0].findField("defaultSkin").getEl().up(".x-form-item").setDisplayed(true)}else{D.forms[0].findField("defaultSkin").hide();D.forms[0].findField("defaultSkin").getEl().up(".x-form-item").setDisplayed(false)}if(D.k&&D.B==null||D.k==false&&D.G==null){Ext.MessageBox.wait("Loading "+
(D.k==true?"global":D.g)+" configuration...","Genie",{interval:75});Ext.Ajax.request({method:"post",url:DOCUMENT_URI,params:{task:"getConfig",skin:D.k==true?"":D.g},callback:function(d,c,e){if(c==false)Ext.MessageBox.alert("Error","Error opening "+(D.k?"global":D.g)+" configuration file: "+e.status+" - "+e.statusText);else{d=Ext.util.JSON.decode(e.responseText);if(d.error!=null)Ext.MessageBox.alert("Error","Error opening "+(D.k?"global":D.g)+" configuration file: "+d.error);else{d=d.config;if(d==
null)d={};if(d.pcListener===true)d.pcCommandMode="listener";if(D.k)D.B=d;else D.G=d;D.hb(d);Ext.MessageBox.hide.defer(500,Ext.MessageBox)}}}})}};
D.hb=function(a){for(var d=D.forms,c,e,f,g,h=0;h<d.length;h++){c=d[h].items.getCount();for(var j=0;j<c;j++){e=d[h].items.itemAt(j);f=e.getXType();e.getValue();g=e.getName();if(f=="combo"){e.setValue(null);e.fireEvent("select",e)}else e.setValue("");if(typeof a[g]!="undefined"&&a[g]!=null){e.setValue(a[g]);if(f=="combo"){f=e.store.findExact(e.valueField,a[g]);g=e.store.getAt(f);e.fireEvent("select",e,g,f)}}}}};
D.$a=function(a){for(var d=D.forms,c,e,f,g=0;g<d.length;g++){f=d[g].items.getCount();for(var h=0;h<f;h++){c=d[g].items.itemAt(h);if(c.isVisible()){e=c.getValue();c=c.getName();c=a[c];if(typeof c=="undefined"){if(e!=null&&String(e)!="")return true}else if(c!=e)return true}}}return false};
D.kb=function(a){for(var d={},c=D.forms,e,f,g,h,j=0;j<c.length;j++){e=c[j].items.getCount();for(var l=0;l<e;l++){f=c[j].items.itemAt(l);if(f.isVisible()){g=f.getValue();if(g!=null&&String(g)!=""){h=f.getName();d[h]=g;if(h=="hostCodePage"){f=f.store.getAt(f.store.findExact("title",g));d.codePageNumber=f.get("codepage")}}}}}Ext.Ajax.request({url:DOCUMENT_URI,method:"post",params:{task:"putConfig",buffer:Ext.util.JSON.encode(d),skin:D.k?"":D.g},callback:function(k,o,m){if(o==false)Ext.MessageBox.show({title:"Error",
msg:"Error saving configuration: "+m.status+" - "+m.statusText,icon:Ext.MessageBox.ERROR,fn:a!=null&&typeof a=="function"?a:null});else{k=Ext.util.JSON.decode(m.responseText);if(k.error!=null)Ext.MessageBox.show({title:"Error",msg:"Error saving configuration: "+k.error,icon:Ext.MessageBox.ERROR,fn:a!=null&&typeof a=="function"?a:null});else{if(D.k)D.B=d;else D.G=d;Ext.MessageBox.show({title:"Genie",msg:"Configuration saved.",icon:Ext.MessageBox.INFO,buttons:Ext.MessageBox.OK,fn:a!=null&&typeof a==
"function"?a:null})}}}})};
D.Ca=function(a){var d=[];d.push({name:"task",value:"putSkinFile"});d.push({name:"skin",value:D.g});d.push({name:"buffer",value:editor.getValue(),fileName:D.q.fileName});var c=new pui.sb;c.yb(d);c.send(DOCUMENT_URI,function(e){var f,g={};if(e.Za()!=200)f=e.wa();if(!f){g=eval("("+e.N()+")");g.success||(f=g.errorText)}if(f)Ext.MessageBox.show({title:"Error",msg:"Error saving file: "+g.errorId+" - "+f,icon:Ext.MessageBox.ERROR,fn:a!=null&&typeof a=="function"?a:null});D.z=editor.getValue();Ext.MessageBox.show({title:"Genie",
msg:D.q.fileName+" saved.",icon:Ext.MessageBox.INFO,buttons:Ext.MessageBox.OK,fn:a!=null&&typeof a=="function"?a:null})})};
D.nb=function(a){D.L.disable();for(var d=0;d<D.o.length;d++)D.l.hideTabStripItem(D.o[d]);D.l.hideTabStripItem(D.q);D.l.activate(D.ga);if(D.Da==false||a!=null&&a==true){Ext.MessageBox.wait("Loading "+D.g+" screens...","Genie",{interval:75});D.ha.loadData([],false);D.ea(function(c){Ext.MessageBox.hide.defer(500,Ext.MessageBox);D.Da=true;for(var e=[],f,g,h,j=0;j<c.screens.length;j++){g=c.screens[j];f=g.screen;h="";for(var l=0;l<g.identifiers.length;l++){if(l!=0)h+=", ";h+=g.identifiers[l].id+' = "'+
g.identifiers[l].value+'"'}e.push(Array(f,h,false))}for(j=0;j<c.windows.length;j++){g=c.windows[j];f=g.screen;h="";for(l=0;l<g.identifiers.length;l++){if(l!=0)h+=", ";h+=g.identifiers[l].id+' = "'+g.identifiers[l].value+'"'}e.push(Array(f,h,true))}D.ha.loadData(e,false)})}};
D.Ib=function(){var a=new Ext.grid.GridPanel({region:"center",id:"GenieAdmin-screensPanel",layout:"fit",title:"Screens",colModel:new Ext.grid.ColumnModel([{header:"Screen Name",dataIndex:"screenName",sortable:true},{header:"Field Identifiers",dataIndex:"idText",sortable:false},{header:"Window",dataIndex:"isWindow",sortable:true,renderer:function(d){return d==true?"Yes":"No"}}]),store:D.ha,stripeRows:true,autoScroll:true,viewConfig:{forceFit:true,autoFill:true},tbar:new Ext.Toolbar({items:[{id:"GenieAdmin-copyScreenButton",
text:"&nbsp;Copy&nbsp;",cls:"x-btn-text-icon",icon:D.i+"copy.png",disabled:true,handler:function(){var d=a.getSelectionModel().getSelections();D.Dc(d,function(){Ext.MessageBox.show({title:"Genie",msg:"The selected screens have been copied to the target skin.",icon:Ext.MessageBox.INFO,buttons:Ext.MessageBox.OK})})}},{id:"GenieAdmin-deleteScreenButton",text:"&nbsp;Delete&nbsp;",cls:"x-btn-text-icon",icon:D.i+"remove.png",disabled:true,handler:function(){var d=a.getSelectionModel().getSelections(),c=
"Are you sure you want to permanently delete the selected screen";if(d.length>1)c+="s";c+="?";Ext.MessageBox.confirm("Genie",c,function(e){if(e=="yes"){D.j.msg="Deleting selected screens...";D.j.show();D.Nb(d,function(){for(var f=a.getStore(),g=0;g<d.length;g++)f.remove(d[g]);D.j.hide();Ext.MessageBox.show({title:"Genie",icon:Ext.MessageBox.INFO,msg:"The selected screens have been deleted.",buttons:Ext.MessageBox.OK})})}})}},{id:"GenieAdmin-refreshScreensButton",text:"&nbsp;Refresh&nbsp;",cls:"x-btn-text-icon",
icon:D.i+"arrow_refresh.png",handler:function(){D.nb(true)}}]}),selModel:new Ext.grid.RowSelectionModel({listeners:{selectionchange:function(d){if(d.getSelections().length==0){Ext.getCmp("GenieAdmin-copyScreenButton").disable();Ext.getCmp("GenieAdmin-deleteScreenButton").disable()}else{Ext.getCmp("GenieAdmin-copyScreenButton").enable();Ext.getCmp("GenieAdmin-deleteScreenButton").enable()}}}})});return a};D.Wb=function(){var a="/profoundui/genie";D.k||(a+="?skin="+encodeURIComponent(D.g));return a};
D.K=function(a,d){if(d!=null&&d==true){a.un("beforeexpand",D.K);a.expand();a.on("beforeexpand",D.K)}else{var c=false,e;if(a.global!=null&&a.global==true)c=true;else e=a.p;if(c==true&&D.k==true||c==false&&e==D.g){D.K(a,true);return false}var f;if(D.k){f=D.B;f="global"}else{f=D.G;f=D.g}D.V(function(){D.yc(e,c,a);D.mb()});return false}};
D.yc=function(a,d,c){D.B=null;D.G=null;D.Da=false;D.k=d;D.g=d==false?a:null;if(d==true){a="Genie";D.qa.disable();D.L.disable()}else{a=a+"&nbsp;Skin";D.qa.enable();D.L.enable()}D.fb.setText("&nbsp;Launch&nbsp;"+a+"&nbsp;");D.K(c,true);c.items.itemAt(0).root.firstChild.select()};
D.O=function(a){var d=a.getEl().parent(),c=new Image;c.src=D.i+"color_picker.gif";c.style.position="relative";c.style.left="3px";c.style.top="3px";c.style.cursor="pointer";Ext.get(c).on("click",function(e){D.ba.Aa=function(g){a.setValue(g)};var f=a.getValue();D.ba.Fa(f);D.ba.show(e)});d.appendChild(c);Ext.QuickTips.register({target:Ext.get(c),text:"Select color"})};
D.Nb=function(a,d){D.ea(function(c){for(var e,f=[],g,h=0;h<a.length;h++){e=a[h].get("screenName");f.push(e);if(a[h].get("isWindow")==false)g=c.screens;else if(a[h].get("isWindow")==true)g=c.windows;for(var j=0;j<g.length;j++)if(g[j].screen==e){g.splice(j,1);break}}D.Mc(c,f,d)})};
D.ea=function(a,d){Ext.Ajax.request({url:DOCUMENT_URI,params:{task:"getScreens",skin:d!=null?d:D.g},callback:function(c,e,f){if(e){c=Ext.util.JSON.decode(f.responseText);if(c.error){D.j.hide();Ext.MessageBox.alert("Error","Error retrieving screens list: "+c.error)}else{if(typeof c.screens=="undefined"&&typeof c.windows=="undefined"){e={};e.screens=c;e.windows=[]}else e=c;a!=null&&typeof(a=="function")&&a(e)}}else{D.j.hide();Ext.MessageBox.alert("Error","Error retrieving screens list: "+f.status+" - "+
f.statusText+".")}}})};
D.Mc=function(a,d,c){a=D.Xa(a);for(var e={task:"deleteScreens",skin:D.g},f=0;f<d.length;f++)e["screen"+(f+1)]=d[f];for(f=d=0;f<a.length;f+=32E3){d++;e["buffer"+d]=a.substr(f,32E3)}Ext.Ajax.request({url:DOCUMENT_URI,params:e,callback:function(g,h,j){if(h){g=Ext.util.JSON.decode(j.responseText);if(g.error){D.j.hide();Ext.MessageBox.alert("Error","Error deleting screens: "+g.error)}else c!=null&&typeof(c=="function")&&c()}else{D.j.hide();Ext.MessageBox.alert("Error","Error deleting screens: "+j.status+
" - "+j.statusText+".")}}})};
D.Dc=function(a,d){function c(o){var m=o.findField("targetSkin").getValue();k.close();D.j.msg="Preparing to copy...";D.j.show();var q,n;D.ea(function(r){q=r;D.ea(function(p){n=p;for(var s=false,t,u=0;u<a.length;u++){p=a[u].get("screenName");if(a[u].get("isWindow")==false)t=n.screens;else if(a[u].get("isWindow")==true)t=n.windows;for(var x=0;x<t.length;x++)if(p==t[x].screen){s=true;break}}D.j.hide();s==true?Ext.MessageBox.show({title:"Genie",msg:"Copying will overwrite duplicate screen definitions in the target skin. Proceed?",icon:Ext.MessageBox.QUESTION,
buttons:Ext.MessageBox.OKCANCEL,fn:function(A){A=="ok"&&D.Sa(D.g,q,m,n,a,d)}}):D.Sa(D.g,q,m,n,a,d)},m)})}for(var e=new Ext.data.ArrayStore({fields:["skin"]}),f=D.u.getCount(),g,h=[],j=0;j<f;j++){g=D.u.getAt(j).get("skin");g!=""&&g!=D.g&&h.push(Array(g))}e.loadData(h);var l=new Ext.form.FormPanel({frame:true,buttonAlign:"right",labelWidth:65,submit:function(){c(l.getForm())},items:[new Ext.form.ComboBox({fieldLabel:"Target skin",name:"targetSkin",mode:"local",editable:false,forceSelection:true,triggerAction:"all",
store:e,value:e.getAt(0).get("skin"),displayField:"skin",valueField:"skin"})],buttons:[{text:"OK",handler:function(){l.submit()}},{text:"Cancel",handler:function(){k.close()}}]}),k=new Ext.Window({title:"Copy Screens",layout:"fit",modal:true,closable:true,resizable:false,width:FLAT_LOOK?285:275,height:120,items:[l],listeners:{show:function(){var o=l.getForm().items.itemAt(0);o.focus.defer(150,o)}}});k.show()};
D.Sa=function(a,d,c,e,f,g){D.j.msg="Copying...";D.j.show();for(var h=[],j,l,k,o,m,q=0;q<f.length;q++){j=f[q].get("screenName");l=null;if(f[q].get("isWindow")==false){o=d.screens;m=e.screens}else if(f[q].get("isWindow")==true){o=d.windows;m=e.windows}for(k=0;k<o.length;k++)if(j==o[k].screen){l=o[k];break}if(l!=null){h.push(j);k=false;for(var n=0;n<m.length;n++)if(j==m[n].screen){m[n]=l;k=true;break}k==false&&m.push(l)}}d=D.Xa(e);a={task:"copyScreens",source:a,target:c};for(q=0;q<h.length;q++)a["screen"+
(q+1)]=h[q];for(q=h=0;q<d.length;q+=32E3){h++;a["buffer"+h]=d.substr(q,32E3)}Ext.Ajax.request({url:DOCUMENT_URI,method:"post",params:a,callback:function(r,p,s){D.j.hide();if(p){r=Ext.util.JSON.decode(s.responseText);if(r.error)Ext.MessageBox.alert("Error","Error copying screens: "+r.error);else g!=null&&typeof(g=="function")&&g()}else Ext.MessageBox.alert("Error","Error copying screens: "+s.status+" - "+s.statusText+".")}})};
D.Xa=function(a){for(var d,c="{",e=1;e<=2;e++){if(e==1){d=a.screens;c+='\n  "screens": ['}else if(e==2){d=a.windows;c+=',\n  "windows": ['}for(var f=0;f<d.length;f++){c+='\n    {\n      "screen": "'+d[f].screen+'",';c+='\n      "identifiers": [';for(var g=d[f].identifiers,h=0;h<g.length;h++){var j=g[h].value;if(j==null)j="";j=j.replace(/\\/g,"\\\\");j=j.replace(/"/g,'\\"');j=j.replace(/\r/g,"\\r");j=j.replace(/\n/g,"\\n");j=j.replace(/\t/g,"\\t");c+='\n        { "id": "'+g[h].id+'", "value": "'+j+
'" }';if(h!=g.length-1)c+=","}c+="\n      ]";c+="\n    }";if(f!=d.length-1)c+=","}c+="\n  ]"}c+="\n}";return c};
D.Cc=function(){var a="Version "+window.pui.baseVersion+", Fix Pack "+window.pui.fixPackVersion+"<br /><br />";a+="Copyright &copy 1999-"+(new Date).getFullYear()+" Profound Logic Software, Inc.<br /><br />";a+="Warning: This computer program is protected by copyright law<br />";a+="and international treaties. Unauthorized reproduction or<br />";a+="distribution of this program, or any portion of it, may result in<br />";a+="severe civil and criminal penalties, and will be prosecuted to the<br />";
a+="maximum extent possible under the law.<br /><br />";a+="Patented. &nbsp;U.S. Patent No. 8,667,405 B2.";Ext.MessageBox.show({title:"Profound UI Genie",msg:a,icon:Ext.MessageBox.INFO,buttons:{no:"Close"}})};
D.Ec=function(){function a(e){var f=e.findField("skinName").getValue(),g;if(f.toUpperCase()==D.g.toUpperCase())g="The new skin name must be different than the current skin.";else if(f.indexOf(".")!=-1)g='The skin name cannot contain a "."';if(g!=null)Ext.MessageBox.show({title:"Genie",icon:Ext.MessageBox.ERROR,buttons:Ext.MessageBox.OK,msg:g,fn:function(){e.findField("skinName").focus()}});else{g=D.u.getCount();for(var h,j=false,l=0;l<g;l++){h=D.u.getAt(l).get("skin");if(h.toUpperCase()==f.toUpperCase()){j=
true;break}}if(j)Ext.MessageBox.confirm("Genie",h+" skin is already defined. Copying will overwrite duplicate files in "+h+". Proceed?",function(k){if(k=="yes"){c.close();D.Ta(f,false)}});else{c.close();D.Ta(f,true)}}}var d=new Ext.FormPanel({frame:true,labelWidth:80,buttonAlign:"right",monitorValid:true,submit:function(){a(d.getForm())},items:[new Ext.form.TextField({fieldLabel:"Skin name",labelStyle:"left:5px;margin-top:10px;",name:"skinName",width:200,allowBlank:false,msgTarget:"under",style:{"margin-top":"10px",
left:"5px"}})],buttons:[{text:"OK",ld:true,handler:function(){d.submit()}},{text:"Cancel",handler:function(){c.close()}}],keys:[{key:Ext.EventObject.ENTER,fn:function(){d.getForm().isValid()&&d.submit()}}]}),c=new Ext.Window({title:"Copy Skin",modal:true,width:320,height:FLAT_LOOK?150:130,layout:"fit",items:[d],listeners:{show:function(){var e=d.getForm().items.itemAt(0);e.focus.defer(150,e)}}});c.show()};
D.Ta=function(a,d){D.j.msg="Copying skin...";D.j.show();Ext.Ajax.request({url:DOCUMENT_URI,method:"post",params:{task:"copySkin",from:D.g,to:a},callback:function(c,e,f){D.j.hide();if(e){c=Ext.util.JSON.decode(f.responseText);c.error?Ext.MessageBox.show({title:"Error",icon:Ext.MessageBox.ERROR,buttons:Ext.MessageBox.OK,msg:"Error copying skin: "+c.error+"."}):Ext.MessageBox.show({title:"Genie",icon:Ext.MessageBox.INFO,buttons:Ext.MessageBox.OK,msg:"Skin copied successfully.",fn:function(){if(d==true){D.m.push(a);
var g=new (Ext.data.Record.create([{name:"skin"}]))({skin:a});D.u.add(g);g=new Ext.tree.TreePanel({rootVisible:false,lines:false,root:new Ext.tree.TreeNode({text:""})});g.root.appendChild(new Ext.tree.TreeNode({text:"Configuration",p:a,listeners:{click:D.oa},icon:D.i+"wrench.png"}));g.root.appendChild(new Ext.tree.TreeNode({text:"Screens",p:a,listeners:{click:D.lb},icon:D.i+"application_cascade.png"}));if(D.ta){g.root.appendChild(new Ext.tree.TreeNode({text:"Edit start.html",p:a,listeners:{click:function(){D.M("start.html")}},
icon:D.i+"code.png"}));g.root.appendChild(new Ext.tree.TreeNode({text:"Edit custom.js",p:a,listeners:{click:function(){D.M("custom.js")}},icon:D.i+"code.png"}));g.root.appendChild(new Ext.tree.TreeNode({text:"Edit "+a+".css",p:a,listeners:{click:function(){D.M(D.g+".css")}},icon:D.i+"code.png"}))}D.v.add(new Ext.Panel({title:a+" Skin",layout:"fit",hideCollapseTool:false,items:[g],p:a,collapsed:true,bodyStyle:"background-color: #FFFFFF;",listeners:{beforeexpand:D.K}}));D.v.doLayout()}}})}else Ext.MessageBox.show({title:"Error",
icon:Ext.MessageBox.ERROR,buttons:Ext.MessageBox.OK,msg:"Error copying skin: HTTP "+f.status+" - "+f.statusText+"."})}})};D.Fc=function(){Ext.MessageBox.confirm("Genie","Are you sure you want to permanently delete the "+D.g+" skin?",function(a){a=="yes"&&D.Ob()})};
D.Ob=function(){D.j.msg="Deleting skin...";D.j.show();Ext.Ajax.request({url:DOCUMENT_URI,method:"post",params:{task:"deleteSkin",skin:D.g},callback:function(a,d,c){D.j.hide();if(d){a=Ext.util.JSON.decode(c.responseText);a.error?Ext.MessageBox.show({title:"Error",icon:Ext.MessageBox.ERROR,buttons:Ext.MessageBox.OK,msg:"Error deleting skin: "+a.error+"."}):Ext.MessageBox.show({title:"Genie",icon:Ext.MessageBox.INFO,buttons:Ext.MessageBox.OK,msg:"Skin deleted successfully.",fn:function(){for(var e=0;e<
D.m.length;e++)if(D.m[e]==D.g){D.m.splice(e,1);break}var f=D.u.getCount(),g;for(e=0;e<f;e++){g=D.u.getAt(e);if(g.get("skin")==D.g){D.u.remove(g);break}}f=D.v.items.getCount();for(e=0;e<f;e++){g=D.v.items.itemAt(e);if(typeof g.p!="undefined"&&g.p==D.g){D.v.remove(g);D.v.doLayout();break}}D.v.items.itemAt(0).expand()}})}else Ext.MessageBox.show({title:"Error",icon:Ext.MessageBox.ERROR,buttons:Ext.MessageBox.OK,msg:"Error deleting skin: HTTP "+c.status+" - "+c.statusText+"."})}})};
function E(){this.t=this.w=this.n=this.Aa=null;var a=this;(function(){Ext.get(document).on("mousedown",function(q){for(q=q.getTarget();q!=null;){if(q==a.n)return;q=q.parentNode}a.hide()});a.n=document.createElement("table");a.n.style.position="absolute";a.n.style.visibility="hidden";a.n.style.backgroundColor="white";a.n.style.border="1px solid #cccccc";a.n.style.zIndex=3E4;var d=["00","33","66","99","CC","FF"],c=0,e=0,f=0,g=a.n.insertRow(a.n.rows.length);g=g.insertCell(g.cells.length);g.colSpan=18;
g.align="center";a.t=document.createElement("input");a.t.style.width="50px";a.t.style.height="15px";a.t.style.border="1px solid white";a.t.style.fontFamily="Arial";a.t.style.fontSize="11px";a.t.style.cursor="default";a.t.style.backgroundColor="white";a.t.disabled=true;a.w=document.createElement("input");a.w.style.width="15px";a.w.style.height="17px";a.w.style.border="1px solid #cccccc";a.w.style.styleFloat="left";a.w.style.cursor="default";a.w.disabled=true;var h=document.createElement("span");h.innerHTML=
"NO COLOR";h.style.backgroundColor="#eeeeee";h.style.color="#666666";h.style.border="1px solid #cccccc";h.style.fontFamily="Arial";h.style.fontSize="10px";h.style.cursor="pointer";h.onclick=function(){a.Aa("");a.hide()};h.onmouseover=function(){h.style.textDecoration="underline";a.Fa("")};h.onmouseout=function(){h.style.textDecoration=""};var j=document.createElement("span");j.innerHTML="CLOSE";j.style.backgroundColor="#eeeeee";j.style.color="#666666";j.style.border="1px solid #cccccc";j.style.fontFamily=
"Arial";j.style.fontSize="10px";j.style.cursor="pointer";j.onclick=function(){a.hide()};j.onmouseover=function(){j.style.textDecoration="underline"};j.onmouseout=function(){j.style.textDecoration=""};g.appendChild(a.t);g.appendChild(a.w);g.appendChild(document.createTextNode("  |  "));g.appendChild(h);g.appendChild(document.createTextNode("   "));g.appendChild(j);for(g=0;g<12;g++)for(var l=a.n.insertRow(a.n.rows.length),k=0;k<18;k++){var o=l.insertCell(l.cells.length),m="#"+d[c]+d[e]+d[f];o.style.backgroundColor=
m;o.title=m;o.style.width="12px";o.style.height="14px";o.style.cursor="pointer";Ext.get(o).on("mouseover",function(q){a.Fa(q.getTarget().title)});Ext.get(o).on("click",function(q){a.Aa(q.getTarget().title);a.hide()});f++;if(f>5){f=0;e++;if(e>5){e=0;c++}}}document.body.appendChild(a.n)})();this.show=function(d){var c=document.body.offsetWidth;if(c==null)c=1E4;c-=320;if(c<0)c=0;var e=d.getXY();d=e[0];e=e[1];if(d>c)d=c;a.n.style.left=d+"px";a.n.style.top=e+"px";a.n.style.visibility="visible"};this.hide=
function(){a.n.style.visibility="hidden"};this.Fa=function(d){a.t.value=d;try{a.w.style.backgroundColor=d}catch(c){a.w.style.backgroundColor=""}}}
D.V=function(a){var d=D.k==true?D.B:D.G,c=D.k==true?"global":D.g;if(d!=null&&D.$a(d))Ext.MessageBox.confirm("Genie","Save changes to "+c+" configuration?",function(e){if(e=="yes")D.kb(a);else{D.hb(D.k==true?D.B:D.G);a()}});else D.z!=null&&D.z!=editor.getValue()?Ext.MessageBox.confirm("Genie","Save changes to file "+D.q.fileName+" configuration?",function(e){if(e=="yes")D.Ca(a);else{editor.setValue(D.z);a()}}):a()};
D.Mb=function(a){for(var d="",c=0;c<a.length;c+=4)d+=String.fromCharCode(parseInt(a.substr(c,4),16));return d};D.zb=function(){var a=Ext.Window.prototype.setActive,d=null;Ext.override(Ext.Window,{cls:"blue-window-active",shadow:false,setActive:function(c){a.call(this,c);if(c){d&&d!=this&&d.el&&d.removeClass("active-window");d=this;d.el&&d.addClass("active-window")}}})};
