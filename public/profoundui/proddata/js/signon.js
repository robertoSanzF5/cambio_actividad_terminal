function A(b){this.onready=this.onfail=this.onsuccess=this.suppressAlert=this.password=this.user=this.async=this.url=this.reqData=this.postData=this.method=null;this.headers={};this.params=null;this.sendAsBinary=true;var a=this.overrideMimeType=null,c=null,d=null,e=null,i=typeof pui!="undefined"&&typeof pui.alert!="undefined"?pui.alert:alert,f=this;if(typeof b=="object")for(var j in b){if(typeof this[j]!="undefined")this[j]=b[j]}else this.url=b;if(window.XMLHttpRequest)a=new XMLHttpRequest;else if(window.ActiveXObject)a=
new ActiveXObject("Microsoft.XMLHTTP");else{i("Ajax request error: Unsupported browser.");return}this.send=this.send=function(){function g(){if(a.readyState==4){c=a.status+" - "+a.statusText;f.onready!=null&&f.onready(f);if(a.status==200){d=true;f.onsuccess!=null&&f.onsuccess(f)}else{d=false;f.suppressAlert!=true&&i(c);f.onfail!=null&&f.onfail(f)}e=false}}var l=null,m=null,k=null;if(f.method==null)l="GET";else if(typeof f.method!="string"&&(f.method.toUpperCase()!="GET"||f.method.toUpperCase()!="POST"||
f.method.toUpperCase()!="PUT")){i('Invalid value for property: "method".');return}else l=f.method.toUpperCase();if(l=="POST"||l=="PUT"){if(f.reqData!=null)k=f.reqData;else if(f.postData!=null)k=f.postData;if(k!=null){if(typeof k!="string"){i('Invalid value for property: "postData".');return}}else k=""}if(f.async==null)m=true;else if(f.async!=true&&f.async!=false){i('Invalid value for property: "async".');return}else m=f.async;if(typeof f.url!="string")i('Invalid value for property: "url".');else{if(f.user!=
null)if(typeof f.user!="string"){i('Invalid value for property: "user".');return}if(f.password!=null)if(typeof f.password!="string"){i('Invalid value for property: "password".');return}if(f.onsuccess!=null)if(typeof f.onsuccess!="function"){i('Invalid value for event: "onsuccess".');return}if(f.onfail!=null)if(typeof f.onfail!="function"){i('Invalid value for event: "onfail".');return}if(f.onready!=null)if(typeof f.onready!="function"){i('Invalid value for event: "onready".');return}var u=true;if(k!=
null)for(var t in f.headers)if(t.toUpperCase()=="CONTENT-TYPE")if(f.headers[t].toLowerCase().indexOf("www-form-urlencoded")==-1)u=false;var n=f.url,q=f.params;if(typeof q=="object"){var o="";for(t in q){var r=q[t],p=[];if(typeof r=="object"){if(r.length!=null&&r.length>0)p=r}else p.push(r);for(r=0;r<p.length;r++){if(o!="")o+="&";o+=encodeURIComponent(t)+"="+encodeURIComponent(p[r])}}if(o!="")if(u&&(l=="POST"||l=="PUT")){if(k!=null&&k!="")k+="&";else k="";k+=o}else{u=n.split("?");if(u.length==2&&u[1]!=
"")n=u[0]+"?"+u[1]+"&"+o;else n+="?"+o}}try{typeof f.user=="string"&&typeof f.password=="string"?a.open(l,n,m,f.user,f.password):a.open(l,n,m);n=false;var v=f.headers;for(t in v){a.setRequestHeader(t,v[t]);if(t.toUpperCase()=="CONTENT-TYPE")n=true}if(l=="POST")n||a.setRequestHeader("Content-type","application/x-www-form-urlencoded");typeof f.overrideMimeType=="string"&&typeof a.overrideMimeType=="function"&&a.overrideMimeType(f.overrideMimeType)}catch(w){i(w);return}e=true;if(m==true)a.onreadystatechange=
g;if(f.sendAsBinary==true)try{a.sendAsBinary(k)}catch(z){a.send(k)}else a.send(k);m!=true&&g()}};this.ok=this.J=function(){return d!=null?d:false};this.getResponseText=this.d=function(){return a.responseText};this.getResponseXML=this.t=function(){return a.responseXML};this.getStatus=this.c=function(){return a.status};this.getStatusText=this.l=function(){return a.statusText};this.getStatusMessage=this.u=function(){return c};this.getAllResponseHeaders=this.getAllResponseHeaders=function(){if(d)try{return a.getAllResponseHeaders()}catch(g){i(g)}};
this.getResponseHeader=this.getResponseHeader=function(g){if(d)try{return a.getResponseHeader(g)}catch(l){i(l)}};this.setRequestHeader=this.setRequestHeader=function(g,l){f.headers[g]=l};this.abort=this.abort=function(){if(!(e==null||e==true))try{a.abort()}catch(g){i(g)}}}
function B(b,a){var c,d,e,i="";if(arguments.length==1&&typeof arguments[0]=="object"){c=arguments[0];c.async=null;c.onsuccess=null;if(typeof c.handler=="function"){d=true;e=c.handler}else d=false}else if(a!=null&&typeof a=="function"){d=true;e=a}else d=false;c=new A(arguments[0]);c.async=d;c.onsuccess=function(f){i+=f.d();d==true&&e(i)};c.send();if(d==false)return i}
function D(b,a){var c,d,e,i=null,f=false;if(arguments.length==1&&typeof arguments[0]=="object"){c=arguments[0];c.async=null;c.onsuccess=null;if(c.saveResponse==true)f=true;if(typeof c.handler=="function"){d=true;e=c.handler}else d=false}else if(a!=null&&typeof a=="function"){d=true;e=a}else d=false;c=new A(arguments[0]);c.async=d;c.onsuccess=function(j){j=j.d();if(f&&typeof pui=="object")pui.savedJSON=j;try{i=eval("("+j+")")}catch(g){e(null,g);return}d==true&&e(i)};c.send();if(d==false)return i}
if(typeof window.pui=="undefined")window.pui={};window.RPGspRequest=A;window.pui.Ajax=A;window.pui.AjaxRequest=A;window.ajax=B;
window.ajaxXML=function(b,a){var c,d,e,i=null;if(arguments.length==1&&typeof arguments[0]=="object"){c=arguments[0];c.async=null;c.onsuccess=null;c.onfail=null;c.onsuccess=null;if(typeof c.handler=="function"){d=true;e=c.handler}else d=false}else if(a!=null&&typeof a=="function"){d=true;e=a}else d=false;c=new A(arguments[0]);c.async=d;c.onsuccess=function(f){i=f.t();d==true&&e(i)};c.send();if(d==false)return i};window.ajaxJSON=D;
window.ajaxSubmit=function(b,a){var c,d="",e=typeof pui!="undefined"&&typeof pui.alert!="undefined"?pui.alert:alert;if(typeof b=="object")c=b;else{c=document.getElementById(b);if(c==null)c=document.forms[b]}var i;if(c!=null)i=c.tagName;if(c==null||i==null||i.toUpperCase()!="FORM"){e("Ajax request error: Invalid form object.");return""}if(b.action==""){e("Ajax request error: Invalid form action.");return""}for(e=0;e<c.elements.length;e++){i=c.elements[e];if(i.name!=null&&i.name!=""){var f=false;if(i.tagName==
"INPUT"){var j=i.type;j=j.toLowerCase();if(j=="hidden")f=true;if(j=="password")f=true;if(j=="text")f=true;if(pui.ja(j))f=true;if(j=="")f=true;if(j=="checkbox"||j=="radio")if(i.checked)f=true}if(i.tagName=="TEXTAREA")f=true;if(i.tagName=="SELECT")f=true;if(f){if(d!="")d+="&";d+=i.name+"="+encodeURIComponent(i.value)}}}c=new A(c.action);c.method="POST";c.postData=d;var g="",l;if(a!=null&&typeof a=="function")l=true;else{l=false;c.async=false}c.onsuccess=function(m){g+=m.d();l==true&&a(g)};c.send();
if(l==false)return g};function E(b){var a;b=b!=null&&typeof b=="object"?b:document.getElementById(b);if(b==null)return"";a="";if(b.tagName.toLowerCase()=="div"){a=b.firstChild;a=a!=null&&a.tagName!=null&&a.tagName=="A"?a.innerHTML:b.innerHTML}if(b.tagName=="INPUT"&&b.type=="checkbox"){if(b.checked&&b.i!=null)return b.i;if(!b.checked&&b.Q!=null)return b.Q;return b.checked}if(b.tagName=="INPUT"||b.tagName=="TEXTAREA")a=b.value;if(b.tagName=="SELECT"){a=b.selectedIndex;a=a>=0?b.options[a].value:b.pui&&b.pui.properties&&b.pui.properties.value?
b.pui.properties.value:b.value}if(b.comboBoxWidget!=null)a=b.comboBoxWidget.getValue();if(b.w!=null)a=String(b.value);if(b.e!=null){a="";if(b.e.G&&b.e.K!=null)a=b.e.K;else if(!b.e.G&&b.e.I!=null)a=b.e.I}for(a=a.replace(/&nbsp;/g," ");a.indexOf(String.fromCharCode(160))!=-1;)a=a.replace(String.fromCharCode(160)," ");if(a==b.ca)a="";return a}function I(b){for(;b.charAt(0)==" ";)b=b.replace(b.charAt(0),"");return b}function J(b){return b.replace(/^\s*|\s*$/g,"")}
pui.detachCalendar=function(b){if(typeof b=="string")b=document.getElementById(b);b!=null&&pui.oa(b)};function K(b,a,c){var d=false,e=location.href;e=e.split("?")[0];e=e.split("/");if(e.length>2&&e[e.length-2].toLowerCase()=="auth")d=true;e="/profoundui/";if(d==true||c==true)e+="auth/";e+=b;if(a!=null&&a==true)e+="/"+PSID;if(pui.serverURL!=null)e=pui.serverURL+e;return e}pui.getProgramURL=K;pui.ea=function(b){return pui.s(b).x};pui.fa=function(b){return pui.s(b).y};
pui.s=function(b){b=b||window.event;var a={x:0,y:0};if(b!=null&&b.touches!=null&&b.touches.length==1){a.x=b.touches[0].pageX;a.y=b.touches[0].pageY}else if(b!=null){if(b.pageX)a.x=b.pageX;else if(b.clientX)a.x=b.clientX+(document.documentElement.scrollLeft?document.documentElement.scrollLeft:document.body.scrollLeft);if(b.pageY)a.y=b.pageY;else if(b.clientY)a.y=b.clientY+(document.documentElement.scrollTop?document.documentElement.scrollTop:document.body.scrollTop)}return a};
function O(){var b={},a="";a=location.search.substring(1,location.search.length);if(a.length==0)return b;a=a.replace(/\+/g," ");a=a.split("&");for(var c=0;c<a.length;c++){var d=a[c].split("="),e=decodeURIComponent(d[0]),i="";if(d.length==2)i=decodeURIComponent(d[1]);b[e]=i}return b}if(typeof applyDesignProperty!="undefined")window.U=applyDesignProperty;
pui.o={r:function(b){for(var a="",c=0;c<b.length;c++){var d=b.charCodeAt(c);if(d<128)a+=String.fromCharCode(d);else{if(d>127&&d<2048)a+=String.fromCharCode(d>>6|192);else{a+=String.fromCharCode(d>>12|224);a+=String.fromCharCode(d>>6&63|128)}a+=String.fromCharCode(d&63|128)}}return a},q:function(b){for(var a="",c=0,d=c1=c2=0;c<b.length;){d=b.charCodeAt(c);if(d<128){a+=String.fromCharCode(d);c++}else if(d>191&&d<224){c2=b.charCodeAt(c+1);a+=String.fromCharCode((d&31)<<6|c2&63);c+=2}else{c2=b.charCodeAt(c+
1);c3=b.charCodeAt(c+2);a+=String.fromCharCode((d&15)<<12|(c2&63)<<6|c3&63);c+=3}}return a}};
pui.T={b:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",r:function(b){var a="",c,d,e,i,f,j,g=0;for(b=pui.o.r(b);g<b.length;){c=b.charCodeAt(g++);d=b.charCodeAt(g++);e=b.charCodeAt(g++);i=c>>2;c=(c&3)<<4|d>>4;f=(d&15)<<2|e>>6;j=e&63;if(isNaN(d))f=j=64;else if(isNaN(e))j=64;a=a+this.b.charAt(i)+this.b.charAt(c)+this.b.charAt(f)+this.b.charAt(j)}return a},q:function(b){var a="",c,d,e,i,f,j=0;for(b=b.replace(/[^A-Za-z0-9\+\/\=]/g,"");j<b.length;){c=this.b.indexOf(b.charAt(j++));d=
this.b.indexOf(b.charAt(j++));i=this.b.indexOf(b.charAt(j++));f=this.b.indexOf(b.charAt(j++));c=c<<2|d>>4;d=(d&15)<<4|i>>2;e=(i&3)<<6|f;a+=String.fromCharCode(c);if(i!=64)a+=String.fromCharCode(d);if(f!=64)a+=String.fromCharCode(e)}return a=pui.o.q(a)}};
pui.downloadJSON=function(){if(pui.savedJSON==null)pui.alert("JSON is not available.");else{var b=pui.savedJSON;if(typeof JSON==="object"&&typeof JSON.parse==="function"&&typeof JSON.stringify==="function")try{b=JSON.stringify(JSON.parse(pui.savedJSON),null,"  ")}catch(a){}pui.ba("text/plain","json.txt",b)}};
pui.keepAlive=function(){var b;if(!(context=="genie"&&pui.f.g==true)){if(context=="dspf")b=pui.f==null?K("PUI0001200.pgm"):K("PUI0002110.pgm");else if(context=="genie")b=DOCUMENT_URI;else return false;if(pui.psid!=null&&pui.psid!="")b+="/"+pui.psid;if(pui.overrideSubmitUrl!=null&&typeof pui.overrideSubmitUrl=="function")try{b=pui.overrideSubmitUrl(b)}catch(a){}if(context=="genie")pui.z(pui.f.g=true);if(context=="dspf")pui.n=false;pui.qa();var c={keepalive:"1"};if(pui.isCloud)c.workspace_id=pui.cloud.ws.id;
B({url:b,method:"post",params:c,sendAsBinary:false,suppressAlert:true,handler:function(){pui.D();if(context=="genie")pui.z(pui.f.g=false);if(context=="dspf")pui.n=true;for(var d=0;d<pui.m.length;d++)pui.m[d].unMask()},onfail:function(d){pui.onoffline==null&&!pui["suppress comm errors"]&&pui.alert(pui.ga(d));pui.D();if(context=="genie")pui.z(pui.f.g=false);if(context=="dspf")pui.n=true;for(d=0;d<pui.m.length;d++)pui.m[d].unMask();pui.onoffline!=null&&pui.onoffline()}});return true}};
pui.getWindowSize=function(){var b,a;if(document.body&&document.body.offsetWidth){b=document.body.offsetWidth;a=document.body.offsetHeight}if(document.compatMode=="CSS1Compat"&&document.documentElement&&document.documentElement.offsetWidth){b=document.documentElement.offsetWidth;a=document.documentElement.offsetHeight}if(window.innerWidth&&window.innerHeight){b=window.innerWidth;a=window.innerHeight}if(window.h&&window.h.width&&window.h.height){b=window.h.width;a=window.h.height}if(document.documentElement&&
document.documentElement.clientWidth){b=document.documentElement.clientWidth;a=document.documentElement.clientHeight}if(b==null&&screen!=null)b=screen.width;if(a==null&&screen!=null)a=screen.height;if(b==null)b=800;if(a==null)a=600;return{width:b,height:a}};pui.openURL=function(b){window.open(b)};
pui.normalizeURL=function(b,a){if(b==null||typeof b!="string")return"";if(a==true&&window.puiMobileClient==null)return b;if(b.substr(0,5).toLowerCase()=="http:"||b.substr(0,6).toLowerCase()=="https:")return b;return pui.serverURL!=null?pui.serverURL+b:window.cordova&&b.substr(0,1)=="/"?b.substr(1):b};
pui.animate=function(b){var a=b.element;if(typeof a=="string")a=document.getElementById(a);if(a!=null){var c,d=b.effect;if(d=="fly in left"||d=="fly in right"||d=="fly out left"||d=="fly out right")c="left";else if(d=="fly in up"||d=="fly in down"||d=="fly out up"||d=="fly out down")c="top";else if(d=="fade in"||d=="fade out")c="opacity";else{c=b.properties;if(c==null){c=b.property;if(c==null)return}}if(typeof c=="string")c=[c];var e=b.duration;if(e==null)e="500ms";if(e.substr(e.length-1,1)!="s")e+=
"s";var i=parseInt(e)*1E3;if(e.length>2&&e.substr(e.length-2,2)=="ms")i=parseInt(e);var f=b.type;if(f==null)f="ease";var j=b.from,g=b.to;switch(d){case "fly in right":j=-a.offsetWidth;j+="px";g="0px";break;case "fly in left":j=a.offsetWidth;j+="px";g="0px";break;case "fly out left":g=-a.offsetWidth;g+="px";j="0px";break;case "fly out right":g=a.offsetWidth;g+="px";j="0px";break;case "fly out down":g=a.offsetHeight;g+="px";j="0px";break;case "fly out up":g=-a.offsetHeight;g+="px";j="0px";break;case "fly in up":j=
a.offsetHeight;j+="px";g="0px";break;case "fly in down":j=-a.offsetHeight;j+="px";g="0px";break;case "fade in":j="0";g="100";break;case "fade out":j="100";g="0";break}if(g!=null){var l="";for(d=0;d<c.length;d++){var m=c[d];if(l!="")l+=", ";l+=m+" "+e+" "+f}var k=["transition","MozTransition","WebkitTransition","msTransition","OTransition"];if(j!=null){if(typeof j=="string"||typeof j=="number")j=[j];for(d=0;d<c.length;d++){m=c[d];a.style[m]=j[d]}}setTimeout(function(){for(var u=0;u<k.length;u++)a.style[k[u]]=
l;setTimeout(function(){if(typeof g=="string"||typeof g=="number")g=[g];for(var t=0;t<c.length;t++)a.style[c[t]]=g[t];setTimeout(function(){for(var n=0;n<k.length;n++)a.style[k[n]]="";b.oncomplete!=null&&b.oncomplete()},i)},1)},1)}}};pui.getActiveElement=function(){return context=="genie"?lastActiveElement:pui.activeElement};pui.fieldExit=function(b){var a=pui.getActiveElement();if(a!=null){var c=false;if(b!=null)c=true;context=="genie"?fieldExit(a,c):pui.Z(a)}};
pui.showCalendar=function(b){var a=b;if(typeof b=="string")a=document.getElementById(b);if(a!=null)if(typeof a=="object"){var c=a.calimg;if(c!=null)if(c.click!=null&&typeof c.click=="function")c.click();else c.onclick!=null&&typeof c.onclick=="function"&&setTimeout(function(){c.onclick()},250)}};pui.getComputedStyle=function(b){var a=null;if(window.getComputedStyle)a=window.getComputedStyle(b);else if(b.currentStyle)a=b.currentStyle;return a};
pui.upload=function(b,a){var c=b.dir,d=b.overwrite===true,e;if(typeof b.slimit=="number")e=b.slimit;var i;if(typeof b.flimit=="number")i=b.flimit;var f="";if(typeof b.altname=="string")f=b.altname;var j;if(typeof b.allowedTypes&&b.allowedTypes instanceof Array)j=b.allowedTypes;if(i==null)i=b.files.length;if(e==null||j==null){for(var g,l=[],m=0;m<b.files.length;m++){var k=b.files[m],u=typeof k.type!="undefined"&&k.type!=""?k.type:"application/octet-stream";pui.V(l,u)==-1&&l.push(u);k=k.data&&k.data instanceof
ArrayBuffer?k.data.byteLength:k.size;k=Math.ceil(k/1048576);if(g==null||k>g)g=k}if(e==null)e=g;if(j==null)j=l}g=K("PUI0009109.PGM");g+="?AUTH="+encodeURIComponent(pui.appJob.auth);g+="&mode=ajax";g+="&r="+Math.floor(Math.random()*1E9);if(pui.isCloud)g+="&workspace_id="+pui.cloud.ws.id;l=new FormData;l.append("dir",c);l.append("overwrite",d?"1":"0");l.append("flimit",i);l.append("slimit",e);l.append("altname",f);for(m=0;m<j.length;m++)l.append("type",j[m]);for(m=0;m<b.files.length;m++){k=b.files[m];
if(k.data&&k.data instanceof ArrayBuffer){var t;try{t=new Blob([k.data])}catch(n){c=new window.WebKitBlobBuilder;c.append(k.data);t=c.getBlob()}l.append("file",t)}else l.append("file",k);l.append("filename",k.name)}var q=new XMLHttpRequest;q.open("POST",g,true);q.onreadystatechange=function(){if(q.readyState==4){var o=true,r;if(q.status==200){var p;try{p=eval("("+q.responseText+")")}catch(v){o=false;r="Server response missing or invalid."}if(p){o=p.success;if(!o)if(p.key){r=pui.getLanguageText("runtimeMsg",
"upload "+p.key);if(p.key=="file limit")r=r.replace("&1",i);if(p.key=="size limit")r=r.replace("&1",e)}else r=p.error}}else{o=false;r=q.status+" - "+q.statusText+"."}typeof a=="function"&&a(o,r)}};q.send(l)};pui.getCookie=function(b){var a=document.cookie.split(";"),c="",d="",e="",i="";for(i=0;i<a.length;i++){c=a[i].split("=");d=c[0].replace(/^\s+|\s+$/g,"");if(d==b){if(c.length>1)e=unescape(c[1].replace(/^\s+|\s+$/g,""));return e}}return null};
pui.setCookie=function(b,a,c,d,e,i){var f=new Date;f.setTime(f.getTime());if(c)c=c*1E3*60*60*24;f=new Date(f.getTime()+c);document.cookie=b+"="+escape(a)+(c?";expires="+f.toGMTString():"")+(d?";path="+d:"")+(e?";domain="+e:"")+(i?";secure":"")};pui.deleteCookie=function(b,a,c){if(pui.getCookie(b))document.cookie=b+"="+(a?";path="+a:"")+(c?";domain="+c:"")+";expires=Thu, 01-Jan-1970 00:00:01 GMT"};
pui.refresh=function(b){if(b==null)b={};var a=b.url;b=b.skin;pui.setCookie("puiRefreshId",pui.psid,null,"/");pui.skipConfirm=true;pui.shutdownOnClose=false;pui.confirmOnClose=false;if(b!=null){b="skin="+encodeURIComponent(b);a=window.location.href;var c=a.split("?");a=c[0];c=c[1];if(c==null)c="";qparms=c.split("&");c=false;for(var d=0;d<qparms.length;d++)if(qparms[d].length>=5&&qparms[d].substr(0,5).toLowerCase()=="skin="){qparms[d]=b;c=true}if(!c)if(qparms.length==1&&qparms[0]=="")qparms[0]=b;else qparms.push(b);
c=qparms.join("&");a=a+"?"+c}if(a!=null)window.location.href=a;else window.location.reload()};
pui.downloadURL=function(b){if(pui==null||pui.appJob==null||pui.appJob.auth==null||pui.appJob.auth=="")return pui.is_ie?"":"data:text/html,<!DOCTYPE html><html><body><p>To download, please connect to a Profound UI session.</p></body></html>";var a=b.inline===true;if(b.id==null)return"";var c=K("PUI0009110.PGM");c+="?id="+encodeURIComponent(b.id);if(b.contentType!=null)c+="&type="+encodeURIComponent(b.contentType);if(a)c+="&inline=1";c+="&usehttprc=0";c+="&AUTH="+encodeURIComponent(pui.appJob.auth);
c+="&r="+Math.floor(Math.random()*1E9);return c};pui.download=function(b){var a=pui.downloadURL(b);b=b.inline===true;if(pui==null||pui.appJob==null||pui.appJob.auth==null||pui.appJob.auth=="")b=true;b?pui.openURL(a):pui.link(a)};
pui.focusOnContainer=function(){window.parent!=window&&pui.S(window.parent)&&window.parent.noderun||setTimeout(function(){if(pui.a==null){pui.a=document.createElement("input");pui.a.type=pui.is_touch?"button":"text";pui.a.readOnly=true;pui.a.style.position="absolute";pui.a.style.left="-999px";pui.a.style.top="-999px";pui.a.style.width="10px";pui.a.style.borderStyle="none";pui.a.style.backgroundColor="transparent";pui.runtimeContainer.appendChild(pui.a)}pui.F=true;pui.a.focus();setTimeout(function(){pui.F=
false},0)},1)};pui.addCSS=function(b){var a=document.getElementsByTagName("head")[0],c=document.createElement("style");c.type="text/css";if(pui.is_old_ie)c.styleSheet.cssText=b;else c.innerHTML=b;a.appendChild(c)};
pui.loadCSS=function(b){if(pui.C(b)!=null)return false;var a=document.getElementsByTagName("head")[0],c=document.createElement("link");c.setAttribute("rel","stylesheet");c.setAttribute("type","text/css");c.setAttribute("media","screen");c.setAttribute("href",pui.normalizeURL(b));a.appendChild(c);return true};
pui.removeCSS=function(b){var a=document.getElementsByTagName("head")[0],c=pui.C(b);if(c==null){c=a.getElementsByTagName("style");for(var d=0;d<c.length;d++){var e=c[d];if(e.innerHTML==b||e.styleSheet!=null&&e.styleSheet.cssText==b){a.removeChild(e);return true}}return false}else{a.removeChild(c);return true}};
pui.loadJS=function(b){if(b==null)return null;var a,c,d,e;if(typeof b=="string")a=b;if(typeof b=="object"){a=b.path;c=b.callback;d=b.onerror;e=b.test;if(e!=null&&typeof e=="function"&&e()==true)return false}if(a==null)return null;if(pui.ha(pui.normalizeURL(a))!=null)return false;b=document.getElementsByTagName("head")[0];var i=false,f=document.createElement("script");f.type="text/javascript";f.onreadystatechange=function(){if(f.readyState=="complete"||f.readyState=="loaded")if(!(e!=null&&typeof e==
"function"&&e()!=true)){!i&&c!=null&&c();i=true}};f.onload=function(){if(!(e!=null&&typeof e=="function"&&e()!=true)){!i&&c!=null&&c();i=true}};if(d)f.onerror=d;f.src=pui.normalizeURL(a);b.appendChild(f);return true};
pui.endOfSession=function(b){pui.confirmOnClose=false;pui.shutdownOnClose=false;if(window.puiMobileClient!=null&&window.puiMobileClient.showConnections!=null){window.puiMobileClient.showConnections();b!=null&&pui.alert(b)}else{var a=O().gobackto;if(a!=null){document.body.innerHTML="";b!=null&&pui.alert(b);location.href=a}if(navigator.app!=null&&navigator.app.exitApp!=null){document.body.innerHTML="";b!=null?pui.alert(b,function(){navigator.app.exitApp()}):navigator.app.exitApp()}}};
pui.alert=function(b,a,c,d){if(window.navigator!=null&&window.navigator.notification!=null&&window.navigator.notification.alert!=null)if(a==null&&c==null&&d==null&&window.puiMobileClient!=null&&window.puiMobileClient.alert!=null)window.puiMobileClient.alert(b);else{if(a==null)a=function(){};if(c==null)c="Profound UI";if(d==null)d="OK";window.navigator.notification.alert(b,a,c,d)}else pui.ka&&window.parent&&window.parent!=window&&pui.S(window.parent)&&window.parent.noderun?console.log("Suppressed alert: "+
b):alert(b)};pui.applyProperty=function(b,a,c){return window.applyProperty(b,a,c)};pui.get=function(b){return J(E(b))};
pui.set=function(b,a){var c;c=typeof b=="object"?b:document.getElementById(b);if(c!=null){if(c.tagName=="DIV")if(c.w!=null)c.w.setValue(a);else if(c.comboBoxWidget!=null)c.comboBoxWidget.setValue(a);else if(c.button&&c.button.P)c.button.P.innerHTML=a;else c.innerHTML=a;if(c.tagName=="INPUT"||c.tagName=="SELECT"||c.tagName=="TEXTAREA")if(c.tagName=="INPUT"&&c.type=="checkbox")c.checked=typeof a=="boolean"?a:c.i!=null&&a==c.i?true:false;else c.value=a;if(context=="dspf"||pui.R&&c.k==null){c.modified=
true;pui.ta(c);var d=c.ua;if(c.id!=null&&c.id.indexOf(".")==-1&&c.B!=null)pui.Y[c.B]=true;if(d!=null){d.ia();d.aa=true;pui.pa(c,d.da())}}if(context=="genie"&&c.k!=null&&c.k.idx!=null)pui.response[c.k.idx]=c;pui.W(c);if(c.pui&&c.pui.properties)c.pui.properties.value=a}};
pui.getActiveContainer=function(){if(context=="genie"){for(var b=1,a=document.getElementById("window"+b);a;){var c=document.getElementById("window"+ ++b);if(c)a=c;else break}if(a)return a}else if(context=="dspf"&&pui.H)return pui.H;return pui.runtimeContainer};pui.getDisplayType=function(){return pui.R?"5250-handler":context=="dspf"?"rdf":"5250"};
function P(b){function a(){if(!(i>=e.length)){var f=e[i].command,j=e[i].wait;i+=1;if(c==1||c==2){var g=j?"1":"0";g="http://localhost:"+(typeof pui["pc listener port"]=="number"?pui["pc listener port"]:80)+"/?cmd="+encodeURIComponent(f)+"&wait="+g;if(c==2){g+="&type=image&rnd="+String(Math.random())+String((new Date).getTime());j=new Image;j.onload=function(){a()};j.src=g}else{g=new pui.Ajax(g);g.method="GET";g.async=j?false:true;g.ra=true;g.la=function(m){if(m.c()!=200){console.log("PC Command Listener comm. failure: "+
m.u());console.log("Command: "+f)}};g.ma=function(){a()};g.send()}}else if(c==3)D({url:K("PUI0009117.pgm"),method:"post",params:{cmd:f,auth:pui.appJob.auth},async:true,handler:function(m){if(m!=null)if(m.cmd){m="puilaunch:"+encodeURIComponent(m.cmd);var k=document.createElement("iframe");k.style.display="none";k.src=m;document.body.appendChild(k);setTimeout(function(){k!=null&&k.parentNode!=null&&document.body.removeChild(k);k=null;a()},5E3)}else m.error&&console.log("PC Command signing error:",m.error);
else console.log("Empty response from PC command signing program.")}});else{if(i==0&&e.length>0){j=[];for(g=0;g<e.length;g++)j.push("("+e[g].X+")");f=j.join(" && ")}try{d.runCommand(f)}catch(l){j='Unable to execute "'+f+'".\n\n';if(l!=null)j+=l.name+":\n\n"+l.message+".";alert(j)}}}}var c=0;if(pui["use pc listener"])c=1;if(window.HTTPS!=null&&window.HTTPS=="ON"&&c==1)c=2;if(pui["pc listener mode"])c=parseInt(pui["pc listener mode"]);if(typeof pui["pc command mode"]=="string")switch(pui["pc command mode"]){case "applet":c=
0;break;case "listener":c=1;break;case "listener_m2":c=2;break;case "launcher":c=3;break;default:c=0;console.log("Unsupported pc command mode:",pui["pc command mode"])}if(c==0){var d=document.getElementById("PCCommandApplet");if(!d){pui.p=b;loadPCCommandApplet("runCommandCb");return}}var e=[],i=0;e=typeof b=="string"?[{command:b,wait:false}]:b;a()}window.runCommandCb=function(){P(pui.p);pui.p=null};pui.runPCCommand=P;
pui.isServerBusy=function(){if(typeof context=="undefined")return false;if(context=="dspf"&&pui.n===false||context=="genie"&&pui.f.g===true)return true;for(var b=document.getElementsByTagName("iframe"),a=0;a<b.length;a++){var c=b[a].contentWindow;if(c!=null){var d=null;try{d=c.pui}catch(e){}if(d!=null)if(typeof d==="object")if(typeof d.isServerBusy==="function")if(d.isServerBusy())return true}}return false};
pui.showLastError=function(){if(errors.length==0)alert("No errors have been reported.");else{var b=errors.length-1;alert("Operation: "+errors[b].na+"\nId: "+errors[b].id+"\n\nMessage: "+errors[b].text+"\n"+errors[b].sa)}};
pui.editCode=function(b,a){function c(s,x){var y=["","","","nn/n","nn/nn","nn/nn/n","nn/nn/nn","nnn/nn/nn","nn/nn/nnnn","nnn/nn/nnnn"];if(j.dateEdit==="*ymd"){y[8]="nnnn/nn/nn";y[9]="nnnnn/nn/nn"}y=y[w];s=String(s);s=s.replace(".","");s=s.replace(",","");s=s.replace("-","");s="0000000000"+s;s=s.substr(s.length-x);var L="/";if(j.dateEditSeparator!=null)L=j.dateEditSeparator;for(var G=false,M=0,N="",F=0;F<y.length;F++){var C=y.substr(F,1),Q=y.substr(F+1,1);if(C==="/"||Q==="/")G=true;if(C==="/")C=L;
else{C=s.substr(M,1);M+=1;if(C==="0")G||(C=" ");else G=true}N+=C}return N}function d(s,x,y){for(s+="";s.length<x;)s+=y;return s}var e=null,i=0,f=null,j={},g=2;if(typeof arguments[g]==="number"){e=arguments[g];g++;if(typeof arguments[g]==="number"){i=arguments[g];g++}}if(typeof arguments[g]==="string"){f=arguments[g];g++}if(typeof arguments[g]==="object"){j=arguments[g];g++}var l=false;if(f==="*astfill"){l=true;f=null}var m=false,k=null,u=false,t=g=false;g=" ";if(pui.appJob&&typeof pui.appJob.decimalFormat===
"string")g=pui.appJob.decimalFormat;var n=g==="I"||g==="J",q=g==="J";if(j.decimalEdit!=null){n=j.decimalEdit===","||j.decimalEdit==="0,";q=j.decimalEdit==="0."||j.decimalEdit==="0,"}if(a>="1"&&a<="4")k="999.00";if(a>="A"&&a<="D")k="999.00CR";if(a>="J"&&a<="M")k="999.00-";if(a>="N"&&a<="Q")k="-999.00";if(a=="1"||a=="A"||a=="J"||a=="N"||a=="2"||a=="B"||a=="K"||a=="O")u=true;g=a=="1"||a=="A"||a=="J"||a=="N"||a=="3"||a=="C"||a=="L"||a=="P"?true:false;if(a=="Z")k="999.00";if(a==="X"||a==="Z")t=true;if(a===
"X")m=true;a>="5"&&a<="9"&&pui.alert("User-defined edit code not supported: "+a+".");a>="1"&&a<="9"||a>="A"&&a<="D"||a>="J"&&a<="Q"||a>="X"&&a<="Z"||pui.alert("Invalid edit code: "+a+".");var o=(b||0)+"",r=parseFloat(o,10)||0,p;p=o.replace(/\..*/,"");if(p==="-0")p="-";if((p==""||p=="-")&&q)p="0";var v;v=o;if(v.indexOf(".")==-1)v+=".";v=v.replace(/.*\./,"");var w=p.length;if(w<3)w=3;var z=v.length;if(typeof e==="number")w=e;if(typeof i==="number")z=i;if(a=="Y"){if(w<3||w>9)pui.alert("Length not valid for edit code Y.");
return c(r,w)}e=".";if(n)e=",";if(t)e="";if(z>0){v=d(v,z,"0");if(p==="0"&&!q)p="";o=p+e+v}var H=" ";if(m)H="0";if(l)H="*";if(u){for(i=/(\d+)(\d{3})/;i.test(p);)p=p.replace(i,"$1"+(n?".":",")+"$2");o=p+(z>0?e+v:"");n=w-z-1;n=n>=0?n:0}n=r<0;o=o.replace(/-/g,"");if(k==="(999.00)"){if(n)o="("+o+")"}else if(k==="999.00-")o+=n?"-":" ";else if(k==="999.00CR")o+=n?"CR":"  ";else if(k==="-999.00")if(n)o="-"+o;if(f)o=f=="EUR"?o+" EUR":f=="$"?o.substr(0,1)=="-"?"-"+f+o.substr(1):f+o:f+o;if(!g)if(r===0)o="";
(function(){var s=w;s+=z&&!t?1:0;if(u)s+=parseInt((w-z-1)/3);if(k==="999.00CR")s+=2;if(k==="999.00-")s+=1;if(k==="-999.00")s+=1;if(typeof f==="string")s+=f.length;var x=o;for(x+="";x.length<s;)x=H+x;o=x})();return o};
pui.editWord=function(b,a,c){function d(){if(q.length>0){var p=q.substr(q.length-1,1);q=q.substr(0,q.length-1);if(p=="0"&&q.length==0&&r)p=o?"*":" "}else{p="0";if(r)p=" ";if(o)p="*"}return p}b=String(b);var e={};if(typeof c==="object")e=c;c="$";if(e.currencySymbol!=null)c=e.currencySymbol;var i=a.indexOf("0")+1,f=a.indexOf("*")+1;if(i==0||f!=0&&f<i)i=f;for(var j=-1,g=a.length-1;g>=0;g-=1)if(g+1==i||a.substr(g,1)==" "){j=g;break}f=a.substr(0,j+1);var l="",m="",k=false,u=false,t=a.substr(j+1).indexOf("-")>=
0||a.substr(j+1).indexOf("CR")>=0;for(g=j+1;g<a.length;g++){var n=a.substr(g,1);if(a.substr(g,2)=="CR"){u=true;g++}else if(n=="-")u=true;else if(n!="&")if(!(n=="*"&&!u))if(n.toUpperCase()>="A"&&n.toUpperCase()<="Z"&&t&&!u)a=a.substr(0,g)+" "+a.substr(g+1);else{l=a.substring(j+1,g);m=a.substr(g);k=true;break}}k||(l=a.substr(j+1));g=".";n=" ";if(pui.appJob&&typeof pui.appJob.decimalFormat==="string")n=pui.appJob.decimalFormat;if(typeof e.decimalFormat==="string")n=e.decimalFormat;if(n==="I"||n==="J")g=
",";e=0;g=f.split(g);if(g.length>1)e=g[1].replace(/[^ ]/g,"").length;var q;q=isNaN(Number(b))?"0":String(b);q=q.replace("-","");g=q.split(".");n=g[0];a="";j=null;if(g.length>1)a=g[1];if(j==null||isNaN(j))j=e;for(;a.length>j;)a=a.substr(0,a.length-1);for(;j>a.length;)a+="0";for(q=n+a;q.substr(0,1)=="0";)q=q.substr(1);e="";var o=j=false;var r=a=false;if(i==0)r=true;for(g=f.length-1;g>=0;g-=1){k=n=f.substr(g,1);if(n==" ")k=d();else if(n=="&")k=" ";else if(n=="0"&&g+1==i)k=d();else if(n=="*"){o=true;
k=d()}else if(n==c){if(g+2==i){k=d();a=true}}else if(j){k=" ";if(o)k="*"}e=k+e;if(g<=i)r=true;if(r&&q.length==0)j=true}l=l.replace(/&/g," ");l=l.replace(/\*/g," ");if(b>=0){l=l.replace("CR","  ");l=l.replace("-"," ")}e=e+l+m;b=e.length-1;e=I(e);if(o&&e.substr(0,1)!="*")e="*"+e;if(a)e=c+e;c=0;if(e[e.length-1]==="-")c=1;for(;e.length<=b;)e=" "+e;return e};pui.v=navigator.userAgent.indexOf("Safari")!=-1&&navigator.userAgent.indexOf("Chrome")==-1;
pui.O=function(){for(var b=document.getElementById("auth-form"),a=document.cookie.split("; "),c=false,d=0;d<a.length;d++){var e=a[d].split("=");if(unescape(e[0])=="pui-signon-"+b.action)if(unescape(e[1])=="1"){c=true;break}}if(typeof Storage!="undefined"){a=O();if(a.workstnid)sessionStorage["atrium-params-workstnid"]=a.workstnid;else try{delete sessionStorage["atrium-params-workstnid"]}catch(i){}if(a.suffixid)sessionStorage["atrium-params-suffixid"]=a.suffixid;else try{delete sessionStorage["atrium-params-suffixid"]}catch(f){}if(a.duplicateid)sessionStorage["atrium-params-duplicateid"]=
a.duplicateid;else try{delete sessionStorage["atrium-params-duplicateid"]}catch(j){}}if(c)location.href=b.action;else{if(c=document.getElementById("auth-box"))c.style.display="";b.elements["auth-user"].focus()}};
pui.N=function(){var b=document.getElementById("auth-form"),a=b.elements["auth-user"].value,c=b.elements["auth-password"].value,d=document.getElementById("auth-message");d.innerHTML="";if(J(a)==""){d.innerHTML=authMessages["user required"];b.elements["auth-user"].focus();return false}else if(J(c)==""){d.innerHTML=authMessages["password required"];b.elements["auth-password"].focus();return false}pui.j(function(){var e=new pui.Ajax("/profoundui/pui0005010.pgm");e.async=true;e.method="POST";e.user=a;
e.password=c;if(pui.v){e.user=encodeURIComponent(e.user);e.password=encodeURIComponent(e.password)}e.suppressAlert=true;e.onready=function(i){if(i.c()==200){var f=eval("("+i.d()+")");i=f.days;var j=false;if(f.warn==true)if(i==0){f=authMessages["password expired"];pui.alert(f);j=true}else{f=authMessages["password pending expiration"];f=f.replace(/{DAYS}/g,i);j=confirm(f)}if(j){i="/profoundui/changepass";i+="?user="+encodeURIComponent(a);i+="&next="+encodeURIComponent(b.action);i+="&back="+encodeURIComponent(location.href);
location.href=i}else{document.cookie=escape("pui-signon-"+b.action)+"=1; path=/";location.href=b.action}}else{d.innerHTML=authMessages["invalid credentials"];b.elements["auth-user"].focus()}};e.send()});return false};pui.j=function(b){var a=new pui.Ajax("/profoundui/pui0005010.pgm");a.async=true;a.method="POST";a.user=a.password="PUI_SIGNOFF_USER";a.suppressAlert=true;a.onready=function(){typeof b=="function"&&b()};a.send()};window.pui.signOn=pui.N;window.pui.clearCredentials=pui.j;
window.pui.signOnInit=pui.O;pui.M=function(){var b=O(),a=document.getElementById("change-user"),c=document.getElementById("change-current"),d=a,e=document.getElementById("change-cancel");if(typeof b.user!="undefined"){a.value=b.user.toUpperCase();a.readOnly=true;a.className+=" read-only";d=c}if(typeof b.back=="undefined")e.style.display="none";document.getElementById("change-box").style.display="block";d.focus()};pui.L=function(){var b=O();if(typeof b.back!="undefined")location.href=b.back};
pui.A=function(){var b=O(),a=document.getElementById("change-form"),c=a.elements["change-user"].value,d=a.elements["change-current"].value,e=a.elements["change-new"].value,i=a.elements["change-confirm"].value,f=document.getElementById("change-message");f.innerHTML="";if(J(c)==""){f.innerHTML=passMessages["user required"];a.elements["change-user"].focus();return false}else if(J(d)==""){f.innerHTML=passMessages["current required"];a.elements["change-current"].focus();return false}else if(J(e)==""){f.innerHTML=
passMessages["new required"];a.elements["change-new"].focus();return false}else if(J(i)==""){f.innerHTML=passMessages["confirm required"];a.elements["change-confirm"].focus();return false}else if(e!=i){f.innerHTML=passMessages["must match"];a.elements["change-new"].focus();return false}i=new pui.Ajax("/profoundui/pui0005011.pgm");i.async=true;i.method="POST";i.params={};i.params.user=c;i.params.current=d;i.params["new"]=e;i.suppressAlert=true;i.onready=function(j){if(j.c()!=200){f.innerHTML="HTTP "+
j.c()+" - "+j.l()+".";a.elements["change-user"].focus()}else{var g;try{g=eval("("+j.d()+")");if(typeof g.success!="boolean")throw"";if(!g.success&&typeof g.error!="string")throw"";}catch(l){g={};g.success=false;g.error="The server response is missing or invalid."}if(g.success==false){f.innerHTML=g.error;a.elements["change-user"].focus()}else{pui.alert(passMessages.success);pui.j(function(){var m=new pui.Ajax("/profoundui/pui0005010.pgm");m.async=true;m.method="POST";m.user=c;m.password=e;if(pui.v){m.user=
encodeURIComponent(m.user);m.password=encodeURIComponent(m.password)}m.suppressAlert=true;m.onready=function(k){if(k.c()==200){if(typeof b.next!="undefined")location.href=b.next}else{pui.alert("HTTP "+k.c()+" - "+k.l()+".");a.elements["change-user"].focus()}};m.send()})}}};i.send();return false};window.pui.passInit=pui.M;window.pui.passCancel=pui.L;window.pui.changePass=pui.A;
